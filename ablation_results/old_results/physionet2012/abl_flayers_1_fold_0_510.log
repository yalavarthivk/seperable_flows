train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset physionet2012 --n-gaussians 10 --encoder transformer --flayers 1 --n-heads 1 --n-hidden 64 -ct 36 -ft 0 --fold 0
2025-11-15 19:24:52,398 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=42, flayers=1, n_gaussians=10, n_heads=1, encoder='transformer', enc_layers=1, n_hiddens=64, dataset='physionet2012', forc_time=0, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-15 19:24:52,399 - INFO - Starting training with experiment ID: 1092399
2025-11-15 19:24:52,399 - INFO - Using device: cuda
2025-11-15 19:24:52,430 - INFO - Available Models: {'mTAN', 'TPA', 'NODE', 'ODE-RNN', 'Latent-ODE', 'Informer', 'M-RNN', 'BRITS', 'NCDE', 'IP-Net', 'N-BEATS', 'SET-TS', 'TFT', 'GRU-ODE-Bayes'}
2025-11-15 19:24:52,430 - INFO - Available Datasets: {'Household Consumption', 'tourism1', 'M5', 'Air Quality', 'Character Trajectories', 'Electricity', 'USHCN', 'M3', 'Traffic', 'M4', 'UWAVE', 'Physionet 2012', 'Human Activity', 'Physionet 2019', 'Air Quality Multi-Site', 'tourism2', 'MuJoCo'}
2025-11-15 19:24:52,567 - INFO - Note: detected 80 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
2025-11-15 19:24:52,567 - INFO - Note: NumExpr detected 80 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-15 19:24:52,567 - INFO - NumExpr defaulting to 8 threads.
2025-11-15 19:24:54,129 - WARNING - usetex mode requires TeX.
2025-11-15 19:24:54,181 - INFO - Adding keys as attributes.
2025-11-15 19:25:04,540 - INFO - Model initialized with 105412 parameters
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
Moses                                                   --
├─ModuleList: 1-1                                       --
│    └─RationalLinearSplineFlow: 2-1                    --
│    │    └─Linear: 3-1                                 1,040
│    │    └─Linear: 3-2                                 1,040
│    │    └─Linear: 3-3                                 1,105
│    │    └─Linear: 3-4                                 1,040
│    │    └─Linear: 3-5                                 65
├─MultiGaussian: 1-2                                    --
│    └─Linear: 2-2                                      65
│    └─Linear: 2-3                                      4,160
├─MixtureWeights: 1-3                                   640
│    └─Linear: 2-4                                      65
│    └─Dropout: 2-5                                     --
├─TimeSeriesEncoder: 1-4                                --
│    └─Linear: 2-6                                      2
│    └─Linear: 2-7                                      126
│    └─Linear: 2-8                                      2
│    └─Linear: 2-9                                      126
│    └─Linear: 2-10                                     2,432
│    └─Linear: 2-11                                     2,432
│    └─Linear: 2-12                                     8,256
│    └─Linear: 2-13                                     8,320
│    └─ModuleList: 2-14                                 --
│    │    └─MultiHeadAttention: 3-6                     16,448
│    └─MultiHeadAttention: 2-15                         --
│    │    └─Linear: 3-7                                 4,096
│    │    └─Linear: 3-8                                 4,096
│    │    └─Linear: 3-9                                 4,096
│    │    └─Linear: 3-10                                4,160
│    │    └─ScaledDotProductAttention: 3-11             --
│    └─Linear: 2-16                                     41,600
│    └─ReLU: 2-17                                       --
================================================================================
Total params: 105,412
Trainable params: 105,412
Non-trainable params: 0
================================================================================
2025-11-15 19:25:04,545 - INFO - Model summary:
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
Moses                                                   --
├─ModuleList: 1-1                                       --
│    └─RationalLinearSplineFlow: 2-1                    --
│    │    └─Linear: 3-1                                 1,040
│    │    └─Linear: 3-2                                 1,040
│    │    └─Linear: 3-3                                 1,105
│    │    └─Linear: 3-4                                 1,040
│    │    └─Linear: 3-5                                 65
├─MultiGaussian: 1-2                                    --
│    └─Linear: 2-2                                      65
│    └─Linear: 2-3                                      4,160
├─MixtureWeights: 1-3                                   640
│    └─Linear: 2-4                                      65
│    └─Dropout: 2-5                                     --
├─TimeSeriesEncoder: 1-4                                --
│    └─Linear: 2-6                                      2
│    └─Linear: 2-7                                      126
│    └─Linear: 2-8                                      2
│    └─Linear: 2-9                                      126
│    └─Linear: 2-10                                     2,432
│    └─Linear: 2-11                                     2,432
│    └─Linear: 2-12                                     8,256
│    └─Linear: 2-13                                     8,320
│    └─ModuleList: 2-14                                 --
│    │    └─MultiHeadAttention: 3-6                     16,448
│    └─MultiHeadAttention: 2-15                         --
│    │    └─Linear: 3-7                                 4,096
│    │    └─Linear: 3-8                                 4,096
│    │    └─Linear: 3-9                                 4,096
│    │    └─Linear: 3-10                                4,160
│    │    └─ScaledDotProductAttention: 3-11             --
│    └─Linear: 2-16                                     41,600
│    └─ReLU: 2-17                                       --
================================================================================
Total params: 105,412
Trainable params: 105,412
Non-trainable params: 0
================================================================================
2025-11-15 19:25:06,113 - INFO - Starting training loop...
2025-11-15 19:25:11,648 - INFO - Epoch   1/1000 | Train njNLL: 1.128930 | Train mNLL: 1.248643| Val njNLL: 1.020957 | Val mNLL: 1.191201| Time: 5.54s
2025-11-15 19:25:11,678 - INFO - New best model saved with val_loss: 1.020957
2025-11-15 19:25:16,440 - INFO - Epoch   2/1000 | Train njNLL: 0.951782 | Train mNLL: 1.136963| Val njNLL: 0.843276 | Val mNLL: 1.036482| Time: 4.76s
2025-11-15 19:25:16,466 - INFO - New best model saved with val_loss: 0.843276
2025-11-15 19:25:21,006 - INFO - Epoch   3/1000 | Train njNLL: 0.761365 | Train mNLL: 0.947454| Val njNLL: 0.640836 | Val mNLL: 0.794952| Time: 4.54s
2025-11-15 19:25:21,031 - INFO - New best model saved with val_loss: 0.640836
2025-11-15 19:25:25,787 - INFO - Epoch   4/1000 | Train njNLL: 0.576054 | Train mNLL: 0.707430| Val njNLL: 0.516422 | Val mNLL: 0.644236| Time: 4.76s
2025-11-15 19:25:25,812 - INFO - New best model saved with val_loss: 0.516422
2025-11-15 19:25:30,820 - INFO - Epoch   5/1000 | Train njNLL: 0.505886 | Train mNLL: 0.632379| Val njNLL: 0.489637 | Val mNLL: 0.613231| Time: 5.01s
2025-11-15 19:25:30,846 - INFO - New best model saved with val_loss: 0.489637
2025-11-15 19:25:35,854 - INFO - Epoch   6/1000 | Train njNLL: 0.464891 | Train mNLL: 0.581906| Val njNLL: 0.440868 | Val mNLL: 0.557939| Time: 5.01s
2025-11-15 19:25:35,880 - INFO - New best model saved with val_loss: 0.440868
2025-11-15 19:25:40,949 - INFO - Epoch   7/1000 | Train njNLL: 0.439338 | Train mNLL: 0.556995| Val njNLL: 0.409304 | Val mNLL: 0.527737| Time: 5.07s
2025-11-15 19:25:40,975 - INFO - New best model saved with val_loss: 0.409304
2025-11-15 19:25:45,870 - INFO - Epoch   8/1000 | Train njNLL: 0.404849 | Train mNLL: 0.519377| Val njNLL: 0.376150 | Val mNLL: 0.494303| Time: 4.90s
2025-11-15 19:25:45,896 - INFO - New best model saved with val_loss: 0.376150
2025-11-15 19:25:50,928 - INFO - Epoch   9/1000 | Train njNLL: 0.375991 | Train mNLL: 0.488138| Val njNLL: 0.374717 | Val mNLL: 0.492940| Time: 5.03s
2025-11-15 19:25:50,953 - INFO - New best model saved with val_loss: 0.374717
2025-11-15 19:25:55,958 - INFO - Epoch  10/1000 | Train njNLL: 0.359742 | Train mNLL: 0.471972| Val njNLL: 0.344072 | Val mNLL: 0.453409| Time: 5.00s
2025-11-15 19:25:56,031 - INFO - New best model saved with val_loss: 0.344072
2025-11-15 19:26:01,004 - INFO - Epoch  11/1000 | Train njNLL: 0.347114 | Train mNLL: 0.458823| Val njNLL: 0.335805 | Val mNLL: 0.450179| Time: 4.97s
2025-11-15 19:26:01,030 - INFO - New best model saved with val_loss: 0.335805
2025-11-15 19:26:05,877 - INFO - Epoch  12/1000 | Train njNLL: 0.340839 | Train mNLL: 0.451789| Val njNLL: 0.340787 | Val mNLL: 0.456573| Time: 4.85s
2025-11-15 19:26:10,882 - INFO - Epoch  13/1000 | Train njNLL: 0.323940 | Train mNLL: 0.432562| Val njNLL: 0.318650 | Val mNLL: 0.426776| Time: 5.00s
2025-11-15 19:26:10,908 - INFO - New best model saved with val_loss: 0.318650
2025-11-15 19:26:15,877 - INFO - Epoch  14/1000 | Train njNLL: 0.325028 | Train mNLL: 0.433961| Val njNLL: 0.330123 | Val mNLL: 0.441258| Time: 4.97s
2025-11-15 19:26:20,619 - INFO - Epoch  15/1000 | Train njNLL: 0.316266 | Train mNLL: 0.425611| Val njNLL: 0.311352 | Val mNLL: 0.420837| Time: 4.74s
2025-11-15 19:26:20,644 - INFO - New best model saved with val_loss: 0.311352
2025-11-15 19:26:25,364 - INFO - Epoch  16/1000 | Train njNLL: 0.311633 | Train mNLL: 0.419885| Val njNLL: 0.304646 | Val mNLL: 0.412084| Time: 4.72s
2025-11-15 19:26:25,389 - INFO - New best model saved with val_loss: 0.304646
2025-11-15 19:26:30,135 - INFO - Epoch  17/1000 | Train njNLL: 0.310374 | Train mNLL: 0.419301| Val njNLL: 0.303733 | Val mNLL: 0.412980| Time: 4.75s
2025-11-15 19:26:30,160 - INFO - New best model saved with val_loss: 0.303733
2025-11-15 19:26:35,124 - INFO - Epoch  18/1000 | Train njNLL: 0.304484 | Train mNLL: 0.413022| Val njNLL: 0.301329 | Val mNLL: 0.408873| Time: 4.96s
2025-11-15 19:26:35,150 - INFO - New best model saved with val_loss: 0.301329
2025-11-15 19:26:39,956 - INFO - Epoch  19/1000 | Train njNLL: 0.305788 | Train mNLL: 0.416461| Val njNLL: 0.308587 | Val mNLL: 0.417430| Time: 4.81s
2025-11-15 19:26:44,996 - INFO - Epoch  20/1000 | Train njNLL: 0.300492 | Train mNLL: 0.410660| Val njNLL: 0.303886 | Val mNLL: 0.410815| Time: 5.04s
2025-11-15 19:26:50,015 - INFO - Epoch  21/1000 | Train njNLL: 0.298846 | Train mNLL: 0.409863| Val njNLL: 0.308421 | Val mNLL: 0.420302| Time: 5.02s
2025-11-15 19:26:54,852 - INFO - Epoch  22/1000 | Train njNLL: 0.294517 | Train mNLL: 0.405042| Val njNLL: 0.305321 | Val mNLL: 0.413288| Time: 4.84s
2025-11-15 19:26:59,840 - INFO - Epoch  23/1000 | Train njNLL: 0.291828 | Train mNLL: 0.403624| Val njNLL: 0.298061 | Val mNLL: 0.409491| Time: 4.99s
2025-11-15 19:26:59,866 - INFO - New best model saved with val_loss: 0.298061
2025-11-15 19:27:04,987 - INFO - Epoch  24/1000 | Train njNLL: 0.292955 | Train mNLL: 0.406104| Val njNLL: 0.321762 | Val mNLL: 0.433512| Time: 5.12s
2025-11-15 19:27:10,021 - INFO - Epoch  25/1000 | Train njNLL: 0.289040 | Train mNLL: 0.405631| Val njNLL: 0.284509 | Val mNLL: 0.406893| Time: 5.03s
2025-11-15 19:27:10,047 - INFO - New best model saved with val_loss: 0.284509
2025-11-15 19:27:14,852 - INFO - Epoch  26/1000 | Train njNLL: 0.280248 | Train mNLL: 0.405265| Val njNLL: 0.284625 | Val mNLL: 0.409986| Time: 4.81s
2025-11-15 19:27:19,865 - INFO - Epoch  27/1000 | Train njNLL: 0.275103 | Train mNLL: 0.404804| Val njNLL: 0.273754 | Val mNLL: 0.404106| Time: 5.01s
2025-11-15 19:27:19,891 - INFO - New best model saved with val_loss: 0.273754
2025-11-15 19:27:24,676 - INFO - Epoch  28/1000 | Train njNLL: 0.268410 | Train mNLL: 0.401784| Val njNLL: 0.267652 | Val mNLL: 0.399361| Time: 4.78s
2025-11-15 19:27:24,701 - INFO - New best model saved with val_loss: 0.267652
2025-11-15 19:27:29,604 - INFO - Epoch  29/1000 | Train njNLL: 0.267599 | Train mNLL: 0.402818| Val njNLL: 0.278702 | Val mNLL: 0.411711| Time: 4.90s
2025-11-15 19:27:34,651 - INFO - Epoch  30/1000 | Train njNLL: 0.266834 | Train mNLL: 0.403694| Val njNLL: 0.267934 | Val mNLL: 0.402198| Time: 5.05s
2025-11-15 19:27:39,560 - INFO - Epoch  31/1000 | Train njNLL: 0.264058 | Train mNLL: 0.402443| Val njNLL: 0.273326 | Val mNLL: 0.408396| Time: 4.91s
2025-11-15 19:27:44,510 - INFO - Epoch  32/1000 | Train njNLL: 0.261191 | Train mNLL: 0.399738| Val njNLL: 0.267302 | Val mNLL: 0.401418| Time: 4.95s
2025-11-15 19:27:44,535 - INFO - New best model saved with val_loss: 0.267302
2025-11-15 19:27:49,473 - INFO - Epoch  33/1000 | Train njNLL: 0.257187 | Train mNLL: 0.395792| Val njNLL: 0.270633 | Val mNLL: 0.404969| Time: 4.94s
2025-11-15 19:27:54,319 - INFO - Epoch  34/1000 | Train njNLL: 0.254761 | Train mNLL: 0.393553| Val njNLL: 0.264625 | Val mNLL: 0.400217| Time: 4.85s
2025-11-15 19:27:54,344 - INFO - New best model saved with val_loss: 0.264625
2025-11-15 19:27:59,167 - INFO - Epoch  35/1000 | Train njNLL: 0.256236 | Train mNLL: 0.396200| Val njNLL: 0.262717 | Val mNLL: 0.399646| Time: 4.82s
2025-11-15 19:27:59,192 - INFO - New best model saved with val_loss: 0.262717
2025-11-15 19:28:04,071 - INFO - Epoch  36/1000 | Train njNLL: 0.253430 | Train mNLL: 0.394210| Val njNLL: 0.261991 | Val mNLL: 0.394146| Time: 4.88s
2025-11-15 19:28:04,096 - INFO - New best model saved with val_loss: 0.261991
2025-11-15 19:28:09,017 - INFO - Epoch  37/1000 | Train njNLL: 0.255804 | Train mNLL: 0.395938| Val njNLL: 0.261328 | Val mNLL: 0.396767| Time: 4.92s
2025-11-15 19:28:09,042 - INFO - New best model saved with val_loss: 0.261328
2025-11-15 19:28:14,088 - INFO - Epoch  38/1000 | Train njNLL: 0.251628 | Train mNLL: 0.392619| Val njNLL: 0.257548 | Val mNLL: 0.393582| Time: 5.05s
2025-11-15 19:28:14,113 - INFO - New best model saved with val_loss: 0.257548
2025-11-15 19:28:18,988 - INFO - Epoch  39/1000 | Train njNLL: 0.255719 | Train mNLL: 0.396779| Val njNLL: 0.258450 | Val mNLL: 0.392720| Time: 4.87s
2025-11-15 19:28:24,016 - INFO - Epoch  40/1000 | Train njNLL: 0.252873 | Train mNLL: 0.394347| Val njNLL: 0.266937 | Val mNLL: 0.402392| Time: 5.03s
2025-11-15 19:28:28,984 - INFO - Epoch  41/1000 | Train njNLL: 0.251777 | Train mNLL: 0.394439| Val njNLL: 0.269244 | Val mNLL: 0.408313| Time: 4.97s
2025-11-15 19:28:33,936 - INFO - Epoch  42/1000 | Train njNLL: 0.248938 | Train mNLL: 0.390796| Val njNLL: 0.261706 | Val mNLL: 0.397414| Time: 4.95s
2025-11-15 19:28:38,737 - INFO - Epoch  43/1000 | Train njNLL: 0.248773 | Train mNLL: 0.391085| Val njNLL: 0.261649 | Val mNLL: 0.395560| Time: 4.80s
2025-11-15 19:28:43,603 - INFO - Epoch  44/1000 | Train njNLL: 0.248095 | Train mNLL: 0.390808| Val njNLL: 0.262208 | Val mNLL: 0.399552| Time: 4.87s
2025-11-15 19:28:48,137 - INFO - Epoch  45/1000 | Train njNLL: 0.248629 | Train mNLL: 0.392957| Val njNLL: 0.258135 | Val mNLL: 0.392203| Time: 4.53s
2025-11-15 19:28:52,985 - INFO - Epoch  46/1000 | Train njNLL: 0.246073 | Train mNLL: 0.390350| Val njNLL: 0.255424 | Val mNLL: 0.388079| Time: 4.85s
2025-11-15 19:28:53,010 - INFO - New best model saved with val_loss: 0.255424
2025-11-15 19:28:57,913 - INFO - Epoch  47/1000 | Train njNLL: 0.243520 | Train mNLL: 0.387028| Val njNLL: 0.253768 | Val mNLL: 0.389488| Time: 4.90s
2025-11-15 19:28:57,939 - INFO - New best model saved with val_loss: 0.253768
2025-11-15 19:29:02,868 - INFO - Epoch  48/1000 | Train njNLL: 0.243361 | Train mNLL: 0.386722| Val njNLL: 0.251375 | Val mNLL: 0.385132| Time: 4.93s
2025-11-15 19:29:02,900 - INFO - New best model saved with val_loss: 0.251375
2025-11-15 19:29:07,683 - INFO - Epoch  49/1000 | Train njNLL: 0.242217 | Train mNLL: 0.386798| Val njNLL: 0.255588 | Val mNLL: 0.390602| Time: 4.78s
2025-11-15 19:29:12,589 - INFO - Epoch  50/1000 | Train njNLL: 0.244679 | Train mNLL: 0.388698| Val njNLL: 0.255479 | Val mNLL: 0.392563| Time: 4.91s
2025-11-15 19:29:17,451 - INFO - Epoch  51/1000 | Train njNLL: 0.241818 | Train mNLL: 0.386848| Val njNLL: 0.257501 | Val mNLL: 0.393904| Time: 4.86s
2025-11-15 19:29:22,326 - INFO - Epoch  52/1000 | Train njNLL: 0.240976 | Train mNLL: 0.385296| Val njNLL: 0.261662 | Val mNLL: 0.396742| Time: 4.87s
2025-11-15 19:29:27,088 - INFO - Epoch  53/1000 | Train njNLL: 0.241440 | Train mNLL: 0.386350| Val njNLL: 0.253610 | Val mNLL: 0.387865| Time: 4.76s
2025-11-15 19:29:31,993 - INFO - Epoch  54/1000 | Train njNLL: 0.237312 | Train mNLL: 0.381734| Val njNLL: 0.251756 | Val mNLL: 0.383967| Time: 4.90s
2025-11-15 19:29:36,841 - INFO - Epoch  55/1000 | Train njNLL: 0.240710 | Train mNLL: 0.386402| Val njNLL: 0.259331 | Val mNLL: 0.393790| Time: 4.85s
2025-11-15 19:29:41,703 - INFO - Epoch  56/1000 | Train njNLL: 0.237549 | Train mNLL: 0.383286| Val njNLL: 0.250130 | Val mNLL: 0.387187| Time: 4.86s
2025-11-15 19:29:41,728 - INFO - New best model saved with val_loss: 0.250130
2025-11-15 19:29:46,552 - INFO - Epoch  57/1000 | Train njNLL: 0.237560 | Train mNLL: 0.383623| Val njNLL: 0.252788 | Val mNLL: 0.388438| Time: 4.82s
2025-11-15 19:29:51,505 - INFO - Epoch  58/1000 | Train njNLL: 0.236815 | Train mNLL: 0.383690| Val njNLL: 0.251857 | Val mNLL: 0.383578| Time: 4.95s
2025-11-15 19:29:56,447 - INFO - Epoch  59/1000 | Train njNLL: 0.236802 | Train mNLL: 0.383488| Val njNLL: 0.255069 | Val mNLL: 0.389316| Time: 4.94s
2025-11-15 19:30:01,452 - INFO - Epoch  60/1000 | Train njNLL: 0.239706 | Train mNLL: 0.386663| Val njNLL: 0.250339 | Val mNLL: 0.382837| Time: 5.01s
2025-11-15 19:30:06,525 - INFO - Epoch  61/1000 | Train njNLL: 0.234049 | Train mNLL: 0.380127| Val njNLL: 0.247839 | Val mNLL: 0.381266| Time: 5.07s
2025-11-15 19:30:06,550 - INFO - New best model saved with val_loss: 0.247839
2025-11-15 19:30:11,494 - INFO - Epoch  62/1000 | Train njNLL: 0.230143 | Train mNLL: 0.377378| Val njNLL: 0.250137 | Val mNLL: 0.383806| Time: 4.94s
2025-11-15 19:30:16,500 - INFO - Epoch  63/1000 | Train njNLL: 0.234344 | Train mNLL: 0.381825| Val njNLL: 0.250545 | Val mNLL: 0.386640| Time: 5.01s
2025-11-15 19:30:21,425 - INFO - Epoch  64/1000 | Train njNLL: 0.231590 | Train mNLL: 0.379661| Val njNLL: 0.254546 | Val mNLL: 0.387470| Time: 4.93s
2025-11-15 19:30:26,455 - INFO - Epoch  65/1000 | Train njNLL: 0.229234 | Train mNLL: 0.376578| Val njNLL: 0.252607 | Val mNLL: 0.388933| Time: 5.03s
2025-11-15 19:30:31,369 - INFO - Epoch  66/1000 | Train njNLL: 0.230894 | Train mNLL: 0.378151| Val njNLL: 0.251489 | Val mNLL: 0.385799| Time: 4.91s
2025-11-15 19:30:36,247 - INFO - Epoch  67/1000 | Train njNLL: 0.233272 | Train mNLL: 0.381988| Val njNLL: 0.247577 | Val mNLL: 0.383913| Time: 4.88s
2025-11-15 19:30:36,272 - INFO - New best model saved with val_loss: 0.247577
2025-11-15 19:30:41,395 - INFO - Epoch  68/1000 | Train njNLL: 0.230441 | Train mNLL: 0.378694| Val njNLL: 0.252336 | Val mNLL: 0.387208| Time: 5.12s
2025-11-15 19:30:46,249 - INFO - Epoch  69/1000 | Train njNLL: 0.229063 | Train mNLL: 0.377785| Val njNLL: 0.247936 | Val mNLL: 0.379178| Time: 4.85s
2025-11-15 19:30:51,433 - INFO - Epoch  70/1000 | Train njNLL: 0.225898 | Train mNLL: 0.374639| Val njNLL: 0.246521 | Val mNLL: 0.379443| Time: 5.18s
2025-11-15 19:30:51,458 - INFO - New best model saved with val_loss: 0.246521
2025-11-15 19:30:56,421 - INFO - Epoch  71/1000 | Train njNLL: 0.229604 | Train mNLL: 0.379230| Val njNLL: 0.247004 | Val mNLL: 0.381928| Time: 4.96s
2025-11-15 19:31:01,441 - INFO - Epoch  72/1000 | Train njNLL: 0.227133 | Train mNLL: 0.376501| Val njNLL: 0.240104 | Val mNLL: 0.373615| Time: 5.02s
2025-11-15 19:31:01,470 - INFO - New best model saved with val_loss: 0.240104
2025-11-15 19:31:06,560 - INFO - Epoch  73/1000 | Train njNLL: 0.223858 | Train mNLL: 0.373295| Val njNLL: 0.241715 | Val mNLL: 0.375849| Time: 5.09s
2025-11-15 19:31:11,444 - INFO - Epoch  74/1000 | Train njNLL: 0.221653 | Train mNLL: 0.371351| Val njNLL: 0.251777 | Val mNLL: 0.383347| Time: 4.88s
2025-11-15 19:31:16,433 - INFO - Epoch  75/1000 | Train njNLL: 0.222976 | Train mNLL: 0.372077| Val njNLL: 0.245541 | Val mNLL: 0.377606| Time: 4.99s
2025-11-15 19:31:21,278 - INFO - Epoch  76/1000 | Train njNLL: 0.224044 | Train mNLL: 0.373854| Val njNLL: 0.242470 | Val mNLL: 0.373850| Time: 4.84s
2025-11-15 19:31:26,284 - INFO - Epoch  77/1000 | Train njNLL: 0.222234 | Train mNLL: 0.372215| Val njNLL: 0.244351 | Val mNLL: 0.377585| Time: 5.01s
2025-11-15 19:31:31,104 - INFO - Epoch  78/1000 | Train njNLL: 0.221973 | Train mNLL: 0.371531| Val njNLL: 0.249572 | Val mNLL: 0.383360| Time: 4.82s
2025-11-15 19:31:35,932 - INFO - Epoch  79/1000 | Train njNLL: 0.219284 | Train mNLL: 0.369825| Val njNLL: 0.257872 | Val mNLL: 0.390835| Time: 4.83s
2025-11-15 19:31:41,086 - INFO - Epoch  80/1000 | Train njNLL: 0.221386 | Train mNLL: 0.371911| Val njNLL: 0.248447 | Val mNLL: 0.379018| Time: 5.15s
2025-11-15 19:31:46,100 - INFO - Epoch  81/1000 | Train njNLL: 0.219982 | Train mNLL: 0.371479| Val njNLL: 0.243552 | Val mNLL: 0.376869| Time: 5.01s
2025-11-15 19:31:50,991 - INFO - Epoch  82/1000 | Train njNLL: 0.221370 | Train mNLL: 0.371929| Val njNLL: 0.243053 | Val mNLL: 0.375709| Time: 4.89s
2025-11-15 19:31:55,928 - INFO - Epoch  83/1000 | Train njNLL: 0.219001 | Train mNLL: 0.370385| Val njNLL: 0.245453 | Val mNLL: 0.378378| Time: 4.94s
2025-11-15 19:32:00,857 - INFO - Epoch  84/1000 | Train njNLL: 0.205579 | Train mNLL: 0.358696| Val njNLL: 0.234034 | Val mNLL: 0.366383| Time: 4.93s
2025-11-15 19:32:00,884 - INFO - New best model saved with val_loss: 0.234034
2025-11-15 19:32:05,805 - INFO - Epoch  85/1000 | Train njNLL: 0.202397 | Train mNLL: 0.355867| Val njNLL: 0.235112 | Val mNLL: 0.366938| Time: 4.92s
2025-11-15 19:32:10,755 - INFO - Epoch  86/1000 | Train njNLL: 0.203521 | Train mNLL: 0.357616| Val njNLL: 0.232509 | Val mNLL: 0.364804| Time: 4.95s
2025-11-15 19:32:10,781 - INFO - New best model saved with val_loss: 0.232509
2025-11-15 19:32:15,774 - INFO - Epoch  87/1000 | Train njNLL: 0.203031 | Train mNLL: 0.357585| Val njNLL: 0.237053 | Val mNLL: 0.368168| Time: 4.99s
2025-11-15 19:32:20,611 - INFO - Epoch  88/1000 | Train njNLL: 0.202553 | Train mNLL: 0.357103| Val njNLL: 0.236797 | Val mNLL: 0.367637| Time: 4.84s
2025-11-15 19:32:25,582 - INFO - Epoch  89/1000 | Train njNLL: 0.201195 | Train mNLL: 0.355719| Val njNLL: 0.235315 | Val mNLL: 0.368531| Time: 4.97s
2025-11-15 19:32:30,705 - INFO - Epoch  90/1000 | Train njNLL: 0.200364 | Train mNLL: 0.354921| Val njNLL: 0.231964 | Val mNLL: 0.363559| Time: 5.12s
2025-11-15 19:32:30,731 - INFO - New best model saved with val_loss: 0.231964
2025-11-15 19:32:35,800 - INFO - Epoch  91/1000 | Train njNLL: 0.200700 | Train mNLL: 0.355570| Val njNLL: 0.232699 | Val mNLL: 0.363507| Time: 5.07s
2025-11-15 19:32:40,815 - INFO - Epoch  92/1000 | Train njNLL: 0.200430 | Train mNLL: 0.355274| Val njNLL: 0.232839 | Val mNLL: 0.366329| Time: 5.01s
2025-11-15 19:32:45,604 - INFO - Epoch  93/1000 | Train njNLL: 0.201692 | Train mNLL: 0.356678| Val njNLL: 0.233157 | Val mNLL: 0.365286| Time: 4.79s
2025-11-15 19:32:50,603 - INFO - Epoch  94/1000 | Train njNLL: 0.200212 | Train mNLL: 0.355519| Val njNLL: 0.237981 | Val mNLL: 0.369890| Time: 5.00s
2025-11-15 19:32:55,607 - INFO - Epoch  95/1000 | Train njNLL: 0.202042 | Train mNLL: 0.357758| Val njNLL: 0.237129 | Val mNLL: 0.369108| Time: 5.00s
2025-11-15 19:33:00,694 - INFO - Epoch  96/1000 | Train njNLL: 0.201074 | Train mNLL: 0.356420| Val njNLL: 0.234402 | Val mNLL: 0.365262| Time: 5.09s
2025-11-15 19:33:05,705 - INFO - Epoch  97/1000 | Train njNLL: 0.199717 | Train mNLL: 0.355306| Val njNLL: 0.234377 | Val mNLL: 0.365227| Time: 5.01s
2025-11-15 19:33:10,613 - INFO - Epoch  98/1000 | Train njNLL: 0.198838 | Train mNLL: 0.355209| Val njNLL: 0.236365 | Val mNLL: 0.366102| Time: 4.91s
2025-11-15 19:33:15,583 - INFO - Epoch  99/1000 | Train njNLL: 0.198910 | Train mNLL: 0.355254| Val njNLL: 0.232676 | Val mNLL: 0.364627| Time: 4.97s
2025-11-15 19:33:20,444 - INFO - Epoch 100/1000 | Train njNLL: 0.197500 | Train mNLL: 0.353769| Val njNLL: 0.233754 | Val mNLL: 0.364107| Time: 4.86s
2025-11-15 19:33:25,280 - INFO - Epoch 101/1000 | Train njNLL: 0.198009 | Train mNLL: 0.355229| Val njNLL: 0.239753 | Val mNLL: 0.370226| Time: 4.84s
2025-11-15 19:33:30,383 - INFO - Epoch 102/1000 | Train njNLL: 0.191381 | Train mNLL: 0.349764| Val njNLL: 0.231670 | Val mNLL: 0.362451| Time: 5.10s
2025-11-15 19:33:30,411 - INFO - New best model saved with val_loss: 0.231670
2025-11-15 19:33:35,352 - INFO - Epoch 103/1000 | Train njNLL: 0.189863 | Train mNLL: 0.348462| Val njNLL: 0.229732 | Val mNLL: 0.359897| Time: 4.94s
2025-11-15 19:33:35,377 - INFO - New best model saved with val_loss: 0.229732
2025-11-15 19:33:40,594 - INFO - Epoch 104/1000 | Train njNLL: 0.189149 | Train mNLL: 0.347520| Val njNLL: 0.231010 | Val mNLL: 0.360304| Time: 5.22s
2025-11-15 19:33:45,381 - INFO - Epoch 105/1000 | Train njNLL: 0.188778 | Train mNLL: 0.347131| Val njNLL: 0.232011 | Val mNLL: 0.361519| Time: 4.79s
2025-11-15 19:33:50,432 - INFO - Epoch 106/1000 | Train njNLL: 0.188745 | Train mNLL: 0.347529| Val njNLL: 0.230735 | Val mNLL: 0.360444| Time: 5.05s
2025-11-15 19:33:55,411 - INFO - Epoch 107/1000 | Train njNLL: 0.188791 | Train mNLL: 0.347846| Val njNLL: 0.232554 | Val mNLL: 0.361631| Time: 4.98s
2025-11-15 19:34:00,324 - INFO - Epoch 108/1000 | Train njNLL: 0.188537 | Train mNLL: 0.347314| Val njNLL: 0.231628 | Val mNLL: 0.361720| Time: 4.91s
2025-11-15 19:34:05,366 - INFO - Epoch 109/1000 | Train njNLL: 0.187731 | Train mNLL: 0.346463| Val njNLL: 0.232415 | Val mNLL: 0.361608| Time: 5.04s
2025-11-15 19:34:10,304 - INFO - Epoch 110/1000 | Train njNLL: 0.187943 | Train mNLL: 0.347649| Val njNLL: 0.232526 | Val mNLL: 0.362087| Time: 4.94s
2025-11-15 19:34:15,302 - INFO - Epoch 111/1000 | Train njNLL: 0.188680 | Train mNLL: 0.347540| Val njNLL: 0.230618 | Val mNLL: 0.359920| Time: 5.00s
2025-11-15 19:34:20,201 - INFO - Epoch 112/1000 | Train njNLL: 0.187671 | Train mNLL: 0.346657| Val njNLL: 0.231424 | Val mNLL: 0.360216| Time: 4.90s
2025-11-15 19:34:25,283 - INFO - Epoch 113/1000 | Train njNLL: 0.187386 | Train mNLL: 0.346858| Val njNLL: 0.231427 | Val mNLL: 0.360411| Time: 5.08s
2025-11-15 19:34:30,242 - INFO - Epoch 114/1000 | Train njNLL: 0.186882 | Train mNLL: 0.346365| Val njNLL: 0.231416 | Val mNLL: 0.360608| Time: 4.96s
2025-11-15 19:34:35,076 - INFO - Epoch 115/1000 | Train njNLL: 0.183334 | Train mNLL: 0.344049| Val njNLL: 0.229559 | Val mNLL: 0.359002| Time: 4.83s
2025-11-15 19:34:35,102 - INFO - New best model saved with val_loss: 0.229559
2025-11-15 19:34:40,084 - INFO - Epoch 116/1000 | Train njNLL: 0.182979 | Train mNLL: 0.343721| Val njNLL: 0.230076 | Val mNLL: 0.358546| Time: 4.98s
2025-11-15 19:34:45,031 - INFO - Epoch 117/1000 | Train njNLL: 0.182485 | Train mNLL: 0.343034| Val njNLL: 0.228420 | Val mNLL: 0.357365| Time: 4.95s
2025-11-15 19:34:45,056 - INFO - New best model saved with val_loss: 0.228420
2025-11-15 19:34:50,162 - INFO - Epoch 118/1000 | Train njNLL: 0.182214 | Train mNLL: 0.342689| Val njNLL: 0.229632 | Val mNLL: 0.358209| Time: 5.11s
2025-11-15 19:34:54,931 - INFO - Epoch 119/1000 | Train njNLL: 0.182676 | Train mNLL: 0.343047| Val njNLL: 0.230250 | Val mNLL: 0.358896| Time: 4.77s
2025-11-15 19:34:59,882 - INFO - Epoch 120/1000 | Train njNLL: 0.182014 | Train mNLL: 0.343223| Val njNLL: 0.230870 | Val mNLL: 0.359367| Time: 4.95s
2025-11-15 19:35:04,765 - INFO - Epoch 121/1000 | Train njNLL: 0.182072 | Train mNLL: 0.343102| Val njNLL: 0.230346 | Val mNLL: 0.358916| Time: 4.88s
2025-11-15 19:35:09,823 - INFO - Epoch 122/1000 | Train njNLL: 0.181848 | Train mNLL: 0.342905| Val njNLL: 0.231528 | Val mNLL: 0.359668| Time: 5.06s
2025-11-15 19:35:14,677 - INFO - Epoch 123/1000 | Train njNLL: 0.182319 | Train mNLL: 0.342840| Val njNLL: 0.230969 | Val mNLL: 0.359580| Time: 4.85s
2025-11-15 19:35:19,403 - INFO - Epoch 124/1000 | Train njNLL: 0.182281 | Train mNLL: 0.343595| Val njNLL: 0.232509 | Val mNLL: 0.361087| Time: 4.73s
2025-11-15 19:35:24,278 - INFO - Epoch 125/1000 | Train njNLL: 0.181525 | Train mNLL: 0.342599| Val njNLL: 0.230443 | Val mNLL: 0.358707| Time: 4.88s
2025-11-15 19:35:29,407 - INFO - Epoch 126/1000 | Train njNLL: 0.180722 | Train mNLL: 0.342143| Val njNLL: 0.229304 | Val mNLL: 0.357560| Time: 5.13s
2025-11-15 19:35:34,232 - INFO - Epoch 127/1000 | Train njNLL: 0.181752 | Train mNLL: 0.343322| Val njNLL: 0.231880 | Val mNLL: 0.360114| Time: 4.82s
2025-11-15 19:35:39,159 - INFO - Epoch 128/1000 | Train njNLL: 0.181056 | Train mNLL: 0.342368| Val njNLL: 0.229677 | Val mNLL: 0.357856| Time: 4.93s
2025-11-15 19:35:44,162 - INFO - Epoch 129/1000 | Train njNLL: 0.179054 | Train mNLL: 0.340967| Val njNLL: 0.230124 | Val mNLL: 0.358275| Time: 5.00s
2025-11-15 19:35:49,132 - INFO - Epoch 130/1000 | Train njNLL: 0.178703 | Train mNLL: 0.340852| Val njNLL: 0.229306 | Val mNLL: 0.356976| Time: 4.97s
2025-11-15 19:35:54,074 - INFO - Epoch 131/1000 | Train njNLL: 0.178638 | Train mNLL: 0.341061| Val njNLL: 0.229786 | Val mNLL: 0.357978| Time: 4.94s
2025-11-15 19:35:58,840 - INFO - Epoch 132/1000 | Train njNLL: 0.178984 | Train mNLL: 0.341357| Val njNLL: 0.229190 | Val mNLL: 0.357337| Time: 4.77s
2025-11-15 19:36:03,856 - INFO - Epoch 133/1000 | Train njNLL: 0.178848 | Train mNLL: 0.341080| Val njNLL: 0.229447 | Val mNLL: 0.357486| Time: 5.02s
2025-11-15 19:36:08,707 - INFO - Epoch 134/1000 | Train njNLL: 0.178545 | Train mNLL: 0.340835| Val njNLL: 0.229725 | Val mNLL: 0.357652| Time: 4.85s
2025-11-15 19:36:13,472 - INFO - Epoch 135/1000 | Train njNLL: 0.178653 | Train mNLL: 0.340767| Val njNLL: 0.229328 | Val mNLL: 0.357054| Time: 4.77s
2025-11-15 19:36:18,251 - INFO - Epoch 136/1000 | Train njNLL: 0.178209 | Train mNLL: 0.340725| Val njNLL: 0.228957 | Val mNLL: 0.357360| Time: 4.78s
2025-11-15 19:36:23,207 - INFO - Epoch 137/1000 | Train njNLL: 0.178301 | Train mNLL: 0.340677| Val njNLL: 0.229272 | Val mNLL: 0.356883| Time: 4.96s
2025-11-15 19:36:28,146 - INFO - Epoch 138/1000 | Train njNLL: 0.178403 | Train mNLL: 0.340726| Val njNLL: 0.229154 | Val mNLL: 0.357142| Time: 4.94s
2025-11-15 19:36:33,021 - INFO - Epoch 139/1000 | Train njNLL: 0.178624 | Train mNLL: 0.340951| Val njNLL: 0.230513 | Val mNLL: 0.358097| Time: 4.87s
2025-11-15 19:36:38,013 - INFO - Epoch 140/1000 | Train njNLL: 0.177286 | Train mNLL: 0.340117| Val njNLL: 0.228650 | Val mNLL: 0.356593| Time: 4.99s
2025-11-15 19:36:42,931 - INFO - Epoch 141/1000 | Train njNLL: 0.176689 | Train mNLL: 0.339591| Val njNLL: 0.229201 | Val mNLL: 0.357146| Time: 4.92s
2025-11-15 19:36:47,724 - INFO - Epoch 142/1000 | Train njNLL: 0.176815 | Train mNLL: 0.339733| Val njNLL: 0.228902 | Val mNLL: 0.356700| Time: 4.79s
2025-11-15 19:36:52,753 - INFO - Epoch 143/1000 | Train njNLL: 0.177186 | Train mNLL: 0.339904| Val njNLL: 0.228967 | Val mNLL: 0.356613| Time: 5.03s
2025-11-15 19:36:57,712 - INFO - Epoch 144/1000 | Train njNLL: 0.176804 | Train mNLL: 0.339803| Val njNLL: 0.228933 | Val mNLL: 0.356597| Time: 4.96s
2025-11-15 19:37:02,707 - INFO - Epoch 145/1000 | Train njNLL: 0.177016 | Train mNLL: 0.339787| Val njNLL: 0.229911 | Val mNLL: 0.357622| Time: 5.00s
2025-11-15 19:37:07,515 - INFO - Epoch 146/1000 | Train njNLL: 0.177104 | Train mNLL: 0.340122| Val njNLL: 0.228843 | Val mNLL: 0.356607| Time: 4.81s
2025-11-15 19:37:12,463 - INFO - Epoch 147/1000 | Train njNLL: 0.176872 | Train mNLL: 0.339740| Val njNLL: 0.229024 | Val mNLL: 0.356995| Time: 4.95s
2025-11-15 19:37:12,463 - INFO - Early stopping after 30 epochs without improvement
2025-11-15 19:37:12,464 - INFO - Loading best model for final evaluation...
2025-11-15 19:37:19,013 - INFO - Final Results:
2025-11-15 19:37:19,013 - INFO - Best Val nJNLL: 0.228420
2025-11-15 19:37:19,014 - INFO - Test njNLL: 0.247219
2025-11-15 19:37:19,014 - INFO - Test mNLL: 0.362282
2025-11-15 19:37:19,014 - INFO - Test mse: 0.707636
2025-11-15 19:37:19,014 - INFO - Test robust mse: 0.749737
2025-11-15 19:37:19,014 - INFO - Test crps: 0.536383
2025-11-15 19:37:19,014 - INFO - Test energy score: 2.675978
2025-11-15 19:37:19,014 - INFO - Evaluation Time: 6.53s
