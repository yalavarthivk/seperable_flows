temp_ablation.py --batch-size 64 --epochs 1 -lr 0.001 --dataset ushcn --n-gaussians 10 --flayers 3 --n-heads 2 --n-hidden 128 -ct 36 -ft 12 --fold 0
2025-11-20 17:30:05,383 - INFO - Arguments: Namespace(epochs=1, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=3628190492, flayers=3, n_gaussians=10, n_heads=2, encoder='transformer', enc_layers=1, n_hiddens=128, dataset='ushcn', forc_time=12, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-20 17:30:05,383 - INFO - Starting training with experiment ID: 6205383
2025-11-20 17:30:05,383 - INFO - Using device: cuda
2025-11-20 17:30:05,400 - INFO - Available Models: {'BRITS', 'Informer', 'ODE-RNN', 'GRU-ODE-Bayes', 'mTAN', 'NCDE', 'Latent-ODE', 'TFT', 'NODE', 'IP-Net', 'N-BEATS', 'TPA', 'M-RNN', 'SET-TS'}
2025-11-20 17:30:05,400 - INFO - Available Datasets: {'tourism2', 'MuJoCo', 'Physionet 2012', 'Air Quality', 'USHCN', 'tourism1', 'Human Activity', 'Character Trajectories', 'M4', 'M3', 'Traffic', 'Household Consumption', 'Physionet 2019', 'Air Quality Multi-Site', 'UWAVE', 'Electricity', 'M5'}
2025-11-20 17:30:05,457 - INFO - Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-20 17:30:05,457 - INFO - NumExpr defaulting to 8 threads.
2025-11-20 17:30:06,164 - WARNING - usetex mode requires TeX.
2025-11-20 17:30:06,246 - INFO - File 'USHCN_DeBrouwer2019.parquet' validated successfully 'filehash='9d6011771a0001d53a8a083b5df7a005ff7808a2c2d1c6396c3fcbf43aa46994''.
2025-11-20 17:30:06,365 - INFO - File 'USHCN_DeBrouwer2019.parquet' validated successfully 'filehash='9d6011771a0001d53a8a083b5df7a005ff7808a2c2d1c6396c3fcbf43aa46994''.
2025-11-20 17:30:07,125 - INFO - Model initialized with 537919 parameters
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
Moses                                                   --
├─ModuleList: 1-1                                       --
│    └─RationalLinearSplineFlow: 2-1                    --
│    │    └─Linear: 3-1                                 2,064
│    │    └─Linear: 3-2                                 2,064
│    │    └─Linear: 3-3                                 1,935
│    │    └─Linear: 3-4                                 2,064
│    └─RationalLinearSplineFlow: 2-2                    --
│    │    └─Linear: 3-5                                 2,064
│    │    └─Linear: 3-6                                 2,064
│    │    └─Linear: 3-7                                 1,935
│    │    └─Linear: 3-8                                 2,064
│    └─RationalLinearSplineFlow: 2-3                    --
│    │    └─Linear: 3-9                                 2,064
│    │    └─Linear: 3-10                                2,064
│    │    └─Linear: 3-11                                1,935
│    │    └─Linear: 3-12                                2,064
├─MultiGaussian: 1-2                                    --
│    └─Linear: 2-4                                      129
│    └─Linear: 2-5                                      16,512
├─MixtureWeights: 1-3                                   1,280
│    └─Linear: 2-6                                      129
├─TimeSeriesEncoder: 1-4                                --
│    └─Linear: 2-7                                      2
│    └─Linear: 2-8                                      254
│    └─Linear: 2-9                                      2
│    └─Linear: 2-10                                     254
│    └─Linear: 2-11                                     768
│    └─Linear: 2-12                                     768
│    └─Linear: 2-13                                     32,896
│    └─Linear: 2-14                                     33,024
│    └─ModuleList: 2-15                                 --
│    │    └─MultiHeadAttention: 3-13                    131,200
│    └─MultiHeadAttention: 2-16                         --
│    │    └─Linear: 3-14                                32,768
│    │    └─Linear: 3-15                                32,768
│    │    └─Linear: 3-16                                32,768
│    │    └─Linear: 3-17                                32,896
│    │    └─ScaledDotProductAttention: 3-18             --
│    └─Linear: 2-17                                     165,120
│    └─ReLU: 2-18                                       --
================================================================================
Total params: 537,919
Trainable params: 537,919
Non-trainable params: 0
================================================================================
2025-11-20 17:30:07,127 - INFO - Model summary:
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
Moses                                                   --
├─ModuleList: 1-1                                       --
│    └─RationalLinearSplineFlow: 2-1                    --
│    │    └─Linear: 3-1                                 2,064
│    │    └─Linear: 3-2                                 2,064
│    │    └─Linear: 3-3                                 1,935
│    │    └─Linear: 3-4                                 2,064
│    └─RationalLinearSplineFlow: 2-2                    --
│    │    └─Linear: 3-5                                 2,064
│    │    └─Linear: 3-6                                 2,064
│    │    └─Linear: 3-7                                 1,935
│    │    └─Linear: 3-8                                 2,064
│    └─RationalLinearSplineFlow: 2-3                    --
│    │    └─Linear: 3-9                                 2,064
│    │    └─Linear: 3-10                                2,064
│    │    └─Linear: 3-11                                1,935
│    │    └─Linear: 3-12                                2,064
├─MultiGaussian: 1-2                                    --
│    └─Linear: 2-4                                      129
│    └─Linear: 2-5                                      16,512
├─MixtureWeights: 1-3                                   1,280
│    └─Linear: 2-6                                      129
├─TimeSeriesEncoder: 1-4                                --
│    └─Linear: 2-7                                      2
│    └─Linear: 2-8                                      254
│    └─Linear: 2-9                                      2
│    └─Linear: 2-10                                     254
│    └─Linear: 2-11                                     768
│    └─Linear: 2-12                                     768
│    └─Linear: 2-13                                     32,896
│    └─Linear: 2-14                                     33,024
│    └─ModuleList: 2-15                                 --
│    │    └─MultiHeadAttention: 3-13                    131,200
│    └─MultiHeadAttention: 2-16                         --
│    │    └─Linear: 3-14                                32,768
│    │    └─Linear: 3-15                                32,768
│    │    └─Linear: 3-16                                32,768
│    │    └─Linear: 3-17                                32,896
│    │    └─ScaledDotProductAttention: 3-18             --
│    └─Linear: 2-17                                     165,120
│    └─ReLU: 2-18                                       --
================================================================================
Total params: 537,919
Trainable params: 537,919
Non-trainable params: 0
================================================================================
2025-11-20 17:30:07,128 - INFO - Starting training loop...
epoch_time: 1.197986364364624
Initial memory: 2.06 MB
Current memory: 12.47 MB
Peak memory: 349.66 MB
min queries: 3.0
mx queries: 6.0
