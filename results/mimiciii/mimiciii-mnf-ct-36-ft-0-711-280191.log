train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset mimiciii --n-gaussians 7 --flayers 3 --n-heads 1 --encoder grafiti --enc-layers 4 --n-hidden 128 -ct 36 -ft 0 --fold 0
2025-11-17 13:02:09,136 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=2451157550, flayers=3, n_gaussians=7, n_heads=1, encoder='grafiti', enc_layers=4, n_hiddens=128, dataset='mimiciii', forc_time=0, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-17 13:02:09,138 - INFO - Starting training with experiment ID: 929138
2025-11-17 13:02:09,138 - INFO - Using device: cuda
2025-11-17 13:02:09,299 - INFO - Available Models: {'SET-TS', 'IP-Net', 'BRITS', 'mTAN', 'M-RNN', 'NCDE', 'ODE-RNN', 'GRU-ODE-Bayes', 'NODE', 'Informer', 'TPA', 'N-BEATS', 'Latent-ODE', 'TFT'}
2025-11-17 13:02:09,299 - INFO - Available Datasets: {'tourism2', 'Physionet 2019', 'M4', 'Character Trajectories', 'Air Quality', 'Electricity', 'M3', 'Traffic', 'Human Activity', 'UWAVE', 'USHCN', 'Air Quality Multi-Site', 'tourism1', 'MuJoCo', 'Physionet 2012', 'Household Consumption', 'M5'}
2025-11-17 13:02:09,882 - INFO - Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-17 13:02:09,883 - INFO - NumExpr defaulting to 8 threads.
2025-11-17 13:02:16,886 - WARNING - usetex mode requires TeX.
2025-11-17 13:02:17,340 - INFO - Adding keys as attributes.
2025-11-17 13:02:59,087 - INFO - Model initialized with 1158335 parameters
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    896
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 12,416
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 115,584
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,158,335
Trainable params: 1,158,335
Non-trainable params: 0
=================================================================
2025-11-17 13:02:59,128 - INFO - Model summary:
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    896
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 12,416
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 115,584
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,158,335
Trainable params: 1,158,335
Non-trainable params: 0
=================================================================
2025-11-17 13:02:59,136 - INFO - Starting training loop...
2025-11-17 13:04:31,147 - INFO - Epoch   1/1000 | Train njNLL: 0.774653 | Train mNLL: 0.874170| Val njNLL: 0.591253 | Val mNLL: 0.686924| Time: 92.01s
2025-11-17 13:04:31,448 - INFO - New best model saved with val_loss: 0.591253
2025-11-17 13:05:58,115 - INFO - Epoch   2/1000 | Train njNLL: 0.551744 | Train mNLL: 0.686274| Val njNLL: 0.495850 | Val mNLL: 0.634683| Time: 86.66s
2025-11-17 13:05:58,413 - INFO - New best model saved with val_loss: 0.495850
2025-11-17 13:07:24,427 - INFO - Epoch   3/1000 | Train njNLL: 0.451831 | Train mNLL: 0.612423| Val njNLL: 0.441665 | Val mNLL: 0.601577| Time: 86.01s
2025-11-17 13:07:24,724 - INFO - New best model saved with val_loss: 0.441665
2025-11-17 13:08:50,866 - INFO - Epoch   4/1000 | Train njNLL: 0.375249 | Train mNLL: 0.563375| Val njNLL: 0.377297 | Val mNLL: 0.528435| Time: 86.14s
2025-11-17 13:08:51,165 - INFO - New best model saved with val_loss: 0.377297
2025-11-17 13:10:16,378 - INFO - Epoch   5/1000 | Train njNLL: 0.297978 | Train mNLL: 0.501977| Val njNLL: 0.310018 | Val mNLL: 0.474520| Time: 85.21s
2025-11-17 13:10:16,673 - INFO - New best model saved with val_loss: 0.310018
2025-11-17 13:11:42,274 - INFO - Epoch   6/1000 | Train njNLL: 0.263347 | Train mNLL: 0.481422| Val njNLL: 0.314441 | Val mNLL: 0.501204| Time: 85.60s
2025-11-17 13:13:07,250 - INFO - Epoch   7/1000 | Train njNLL: 0.264725 | Train mNLL: 0.491424| Val njNLL: 0.295520 | Val mNLL: 0.484310| Time: 84.98s
2025-11-17 13:13:07,550 - INFO - New best model saved with val_loss: 0.295520
2025-11-17 13:14:33,300 - INFO - Epoch   8/1000 | Train njNLL: 0.224836 | Train mNLL: 0.459635| Val njNLL: 0.317965 | Val mNLL: 0.517994| Time: 85.75s
2025-11-17 13:15:59,551 - INFO - Epoch   9/1000 | Train njNLL: 0.197247 | Train mNLL: 0.440937| Val njNLL: 0.298699 | Val mNLL: 0.504250| Time: 86.25s
2025-11-17 13:17:25,201 - INFO - Epoch  10/1000 | Train njNLL: 0.180415 | Train mNLL: 0.431194| Val njNLL: 0.224016 | Val mNLL: 0.441761| Time: 85.65s
2025-11-17 13:17:25,636 - INFO - New best model saved with val_loss: 0.224016
2025-11-17 13:18:51,552 - INFO - Epoch  11/1000 | Train njNLL: 0.176541 | Train mNLL: 0.430505| Val njNLL: 0.123561 | Val mNLL: 0.373899| Time: 85.91s
2025-11-17 13:18:51,855 - INFO - New best model saved with val_loss: 0.123561
2025-11-17 13:20:17,852 - INFO - Epoch  12/1000 | Train njNLL: 0.142494 | Train mNLL: 0.410117| Val njNLL: 0.330356 | Val mNLL: 0.545572| Time: 86.00s
2025-11-17 13:21:43,846 - INFO - Epoch  13/1000 | Train njNLL: 0.149300 | Train mNLL: 0.411708| Val njNLL: 0.083129 | Val mNLL: 0.335122| Time: 85.99s
2025-11-17 13:21:44,144 - INFO - New best model saved with val_loss: 0.083129
2025-11-17 13:23:10,264 - INFO - Epoch  14/1000 | Train njNLL: 0.184668 | Train mNLL: 0.445266| Val njNLL: 0.156843 | Val mNLL: 0.394500| Time: 86.12s
2025-11-17 13:24:36,100 - INFO - Epoch  15/1000 | Train njNLL: 0.105675 | Train mNLL: 0.383879| Val njNLL: 0.140873 | Val mNLL: 0.385224| Time: 85.84s
2025-11-17 13:26:02,179 - INFO - Epoch  16/1000 | Train njNLL: 0.112609 | Train mNLL: 0.397765| Val njNLL: 0.079555 | Val mNLL: 0.340286| Time: 86.08s
2025-11-17 13:26:02,480 - INFO - New best model saved with val_loss: 0.079555
2025-11-17 13:27:28,515 - INFO - Epoch  17/1000 | Train njNLL: 0.094705 | Train mNLL: 0.380244| Val njNLL: 0.218617 | Val mNLL: 0.447661| Time: 86.03s
2025-11-17 13:28:54,781 - INFO - Epoch  18/1000 | Train njNLL: 0.111040 | Train mNLL: 0.397288| Val njNLL: 0.113973 | Val mNLL: 0.374234| Time: 86.27s
2025-11-17 13:30:20,904 - INFO - Epoch  19/1000 | Train njNLL: 0.089005 | Train mNLL: 0.383307| Val njNLL: 0.103040 | Val mNLL: 0.362355| Time: 86.12s
2025-11-17 13:31:46,501 - INFO - Epoch  20/1000 | Train njNLL: 0.063158 | Train mNLL: 0.366226| Val njNLL: 0.097033 | Val mNLL: 0.381937| Time: 85.60s
2025-11-17 13:33:12,546 - INFO - Epoch  21/1000 | Train njNLL: 0.081023 | Train mNLL: 0.389899| Val njNLL: 0.099738 | Val mNLL: 0.373318| Time: 86.04s
2025-11-17 13:34:38,042 - INFO - Epoch  22/1000 | Train njNLL: 0.047153 | Train mNLL: 0.366115| Val njNLL: 0.055720 | Val mNLL: 0.342509| Time: 85.50s
2025-11-17 13:34:38,339 - INFO - New best model saved with val_loss: 0.055720
2025-11-17 13:36:04,360 - INFO - Epoch  23/1000 | Train njNLL: 0.021538 | Train mNLL: 0.346027| Val njNLL: 0.063697 | Val mNLL: 0.337728| Time: 86.02s
2025-11-17 13:37:30,122 - INFO - Epoch  24/1000 | Train njNLL: 0.024008 | Train mNLL: 0.349753| Val njNLL: 0.041118 | Val mNLL: 0.329552| Time: 85.76s
2025-11-17 13:37:30,449 - INFO - New best model saved with val_loss: 0.041118
2025-11-17 13:38:55,972 - INFO - Epoch  25/1000 | Train njNLL: 0.008046 | Train mNLL: 0.344005| Val njNLL: 0.033431 | Val mNLL: 0.327795| Time: 85.52s
2025-11-17 13:38:56,425 - INFO - New best model saved with val_loss: 0.033431
2025-11-17 13:40:22,082 - INFO - Epoch  26/1000 | Train njNLL: 0.028738 | Train mNLL: 0.358277| Val njNLL: 0.073447 | Val mNLL: 0.341541| Time: 85.66s
2025-11-17 13:41:47,925 - INFO - Epoch  27/1000 | Train njNLL: 0.027011 | Train mNLL: 0.354841| Val njNLL: 0.120124 | Val mNLL: 0.405273| Time: 85.84s
2025-11-17 13:43:13,468 - INFO - Epoch  28/1000 | Train njNLL: 0.027768 | Train mNLL: 0.357060| Val njNLL: 0.210753 | Val mNLL: 0.444944| Time: 85.54s
2025-11-17 13:44:39,671 - INFO - Epoch  29/1000 | Train njNLL: 0.016467 | Train mNLL: 0.345304| Val njNLL: 0.072683 | Val mNLL: 0.378230| Time: 86.20s
2025-11-17 13:46:05,720 - INFO - Epoch  30/1000 | Train njNLL: 0.027605 | Train mNLL: 0.362008| Val njNLL: 0.155644 | Val mNLL: 0.414428| Time: 86.05s
2025-11-17 13:47:32,217 - INFO - Epoch  31/1000 | Train njNLL: -0.015255 | Train mNLL: 0.329792| Val njNLL: 0.034697 | Val mNLL: 0.335137| Time: 86.50s
2025-11-17 13:48:58,616 - INFO - Epoch  32/1000 | Train njNLL: -0.000156 | Train mNLL: 0.340812| Val njNLL: 0.024129 | Val mNLL: 0.327622| Time: 86.40s
2025-11-17 13:48:58,914 - INFO - New best model saved with val_loss: 0.024129
2025-11-17 13:50:24,543 - INFO - Epoch  33/1000 | Train njNLL: 0.028927 | Train mNLL: 0.364435| Val njNLL: 0.085642 | Val mNLL: 0.374191| Time: 85.63s
2025-11-17 13:51:50,056 - INFO - Epoch  34/1000 | Train njNLL: -0.004872 | Train mNLL: 0.339862| Val njNLL: 0.134779 | Val mNLL: 0.413351| Time: 85.51s
2025-11-17 13:53:16,061 - INFO - Epoch  35/1000 | Train njNLL: -0.052550 | Train mNLL: 0.308894| Val njNLL: 0.031217 | Val mNLL: 0.330037| Time: 86.00s
2025-11-17 13:54:42,134 - INFO - Epoch  36/1000 | Train njNLL: -0.039552 | Train mNLL: 0.322280| Val njNLL: 0.017719 | Val mNLL: 0.314118| Time: 86.07s
2025-11-17 13:54:42,432 - INFO - New best model saved with val_loss: 0.017719
2025-11-17 13:56:08,031 - INFO - Epoch  37/1000 | Train njNLL: 0.008308 | Train mNLL: 0.357387| Val njNLL: 0.031793 | Val mNLL: 0.339248| Time: 85.60s
2025-11-17 13:57:33,612 - INFO - Epoch  38/1000 | Train njNLL: -0.070931 | Train mNLL: 0.303423| Val njNLL: 0.070282 | Val mNLL: 0.362693| Time: 85.58s
2025-11-17 13:58:59,202 - INFO - Epoch  39/1000 | Train njNLL: -0.052706 | Train mNLL: 0.312317| Val njNLL: 0.081202 | Val mNLL: 0.366409| Time: 85.59s
2025-11-17 14:00:25,093 - INFO - Epoch  40/1000 | Train njNLL: -0.036133 | Train mNLL: 0.332539| Val njNLL: 0.045873 | Val mNLL: 0.341723| Time: 85.89s
2025-11-17 14:01:51,392 - INFO - Epoch  41/1000 | Train njNLL: -0.037103 | Train mNLL: 0.322140| Val njNLL: 0.003840 | Val mNLL: 0.305912| Time: 86.30s
2025-11-17 14:01:51,693 - INFO - New best model saved with val_loss: 0.003840
2025-11-17 14:03:18,024 - INFO - Epoch  42/1000 | Train njNLL: -0.036744 | Train mNLL: 0.325971| Val njNLL: 0.037577 | Val mNLL: 0.325517| Time: 86.33s
2025-11-17 14:04:44,153 - INFO - Epoch  43/1000 | Train njNLL: -0.038829 | Train mNLL: 0.330562| Val njNLL: 0.078832 | Val mNLL: 0.365321| Time: 86.13s
2025-11-17 14:06:10,682 - INFO - Epoch  44/1000 | Train njNLL: -0.061202 | Train mNLL: 0.309244| Val njNLL: -0.013070 | Val mNLL: 0.288107| Time: 86.53s
2025-11-17 14:06:10,981 - INFO - New best model saved with val_loss: -0.013070
2025-11-17 14:07:36,955 - INFO - Epoch  45/1000 | Train njNLL: -0.056192 | Train mNLL: 0.319065| Val njNLL: -0.039097 | Val mNLL: 0.276558| Time: 85.97s
2025-11-17 14:07:37,253 - INFO - New best model saved with val_loss: -0.039097
2025-11-17 14:09:03,531 - INFO - Epoch  46/1000 | Train njNLL: -0.094524 | Train mNLL: 0.289771| Val njNLL: -0.010182 | Val mNLL: 0.303625| Time: 86.28s
2025-11-17 14:10:30,008 - INFO - Epoch  47/1000 | Train njNLL: -0.077379 | Train mNLL: 0.302059| Val njNLL: 0.001307 | Val mNLL: 0.317828| Time: 86.48s
2025-11-17 14:11:55,444 - INFO - Epoch  48/1000 | Train njNLL: -0.088228 | Train mNLL: 0.300321| Val njNLL: -0.030128 | Val mNLL: 0.290544| Time: 85.44s
2025-11-17 14:13:20,849 - INFO - Epoch  49/1000 | Train njNLL: -0.067742 | Train mNLL: 0.314001| Val njNLL: -0.067913 | Val mNLL: 0.258852| Time: 85.40s
2025-11-17 14:13:21,150 - INFO - New best model saved with val_loss: -0.067913
2025-11-17 14:14:46,710 - INFO - Epoch  50/1000 | Train njNLL: -0.120361 | Train mNLL: 0.277989| Val njNLL: -0.025308 | Val mNLL: 0.294703| Time: 85.56s
2025-11-17 14:16:12,187 - INFO - Epoch  51/1000 | Train njNLL: -0.126787 | Train mNLL: 0.276423| Val njNLL: 0.049019 | Val mNLL: 0.332499| Time: 85.48s
2025-11-17 14:17:37,042 - INFO - Epoch  52/1000 | Train njNLL: -0.121094 | Train mNLL: 0.282600| Val njNLL: 0.031835 | Val mNLL: 0.339547| Time: 84.85s
2025-11-17 14:19:03,139 - INFO - Epoch  53/1000 | Train njNLL: -0.109804 | Train mNLL: 0.288358| Val njNLL: 0.013526 | Val mNLL: 0.320992| Time: 86.10s
2025-11-17 14:20:29,555 - INFO - Epoch  54/1000 | Train njNLL: -0.125723 | Train mNLL: 0.278203| Val njNLL: 0.051923 | Val mNLL: 0.353176| Time: 86.42s
2025-11-17 14:21:55,677 - INFO - Epoch  55/1000 | Train njNLL: -0.116954 | Train mNLL: 0.281112| Val njNLL: -0.048507 | Val mNLL: 0.274388| Time: 86.12s
2025-11-17 14:23:21,557 - INFO - Epoch  56/1000 | Train njNLL: -0.143187 | Train mNLL: 0.269182| Val njNLL: -0.030166 | Val mNLL: 0.275235| Time: 85.88s
2025-11-17 14:24:47,658 - INFO - Epoch  57/1000 | Train njNLL: -0.145649 | Train mNLL: 0.268310| Val njNLL: -0.046949 | Val mNLL: 0.265033| Time: 86.10s
2025-11-17 14:26:13,419 - INFO - Epoch  58/1000 | Train njNLL: -0.153285 | Train mNLL: 0.264915| Val njNLL: 0.059225 | Val mNLL: 0.349294| Time: 85.76s
2025-11-17 14:27:38,799 - INFO - Epoch  59/1000 | Train njNLL: -0.104260 | Train mNLL: 0.296901| Val njNLL: 0.016053 | Val mNLL: 0.322232| Time: 85.38s
2025-11-17 14:29:04,371 - INFO - Epoch  60/1000 | Train njNLL: -0.137874 | Train mNLL: 0.282042| Val njNLL: -0.011724 | Val mNLL: 0.312848| Time: 85.57s
2025-11-17 14:30:29,823 - INFO - Epoch  61/1000 | Train njNLL: -0.235137 | Train mNLL: 0.215975| Val njNLL: -0.082126 | Val mNLL: 0.265036| Time: 85.45s
2025-11-17 14:30:30,125 - INFO - New best model saved with val_loss: -0.082126
2025-11-17 14:31:55,818 - INFO - Epoch  62/1000 | Train njNLL: -0.269751 | Train mNLL: 0.201470| Val njNLL: -0.106997 | Val mNLL: 0.225779| Time: 85.69s
2025-11-17 14:31:56,121 - INFO - New best model saved with val_loss: -0.106997
2025-11-17 14:33:21,576 - INFO - Epoch  63/1000 | Train njNLL: -0.289257 | Train mNLL: 0.191042| Val njNLL: -0.093564 | Val mNLL: 0.245601| Time: 85.45s
2025-11-17 14:34:47,546 - INFO - Epoch  64/1000 | Train njNLL: -0.266646 | Train mNLL: 0.214622| Val njNLL: -0.093533 | Val mNLL: 0.245089| Time: 85.97s
2025-11-17 14:36:13,157 - INFO - Epoch  65/1000 | Train njNLL: -0.274909 | Train mNLL: 0.206276| Val njNLL: -0.105220 | Val mNLL: 0.241095| Time: 85.61s
2025-11-17 14:37:38,530 - INFO - Epoch  66/1000 | Train njNLL: -0.314107 | Train mNLL: 0.186402| Val njNLL: -0.043850 | Val mNLL: 0.275761| Time: 85.37s
2025-11-17 14:39:04,150 - INFO - Epoch  67/1000 | Train njNLL: -0.313383 | Train mNLL: 0.190523| Val njNLL: -0.071978 | Val mNLL: 0.258811| Time: 85.62s
2025-11-17 14:40:29,635 - INFO - Epoch  68/1000 | Train njNLL: -0.287739 | Train mNLL: 0.208394| Val njNLL: -0.080416 | Val mNLL: 0.257425| Time: 85.48s
2025-11-17 14:41:55,883 - INFO - Epoch  69/1000 | Train njNLL: -0.320308 | Train mNLL: 0.185581| Val njNLL: -0.073289 | Val mNLL: 0.258808| Time: 86.25s
2025-11-17 14:43:21,332 - INFO - Epoch  70/1000 | Train njNLL: -0.340259 | Train mNLL: 0.179387| Val njNLL: -0.117167 | Val mNLL: 0.224471| Time: 85.45s
2025-11-17 14:43:21,631 - INFO - New best model saved with val_loss: -0.117167
2025-11-17 14:44:46,871 - INFO - Epoch  71/1000 | Train njNLL: -0.330149 | Train mNLL: 0.182922| Val njNLL: -0.085770 | Val mNLL: 0.235176| Time: 85.24s
2025-11-17 14:46:12,781 - INFO - Epoch  72/1000 | Train njNLL: -0.331222 | Train mNLL: 0.186859| Val njNLL: -0.092974 | Val mNLL: 0.235620| Time: 85.91s
2025-11-17 14:47:38,421 - INFO - Epoch  73/1000 | Train njNLL: -0.344110 | Train mNLL: 0.177740| Val njNLL: -0.084532 | Val mNLL: 0.254657| Time: 85.64s
2025-11-17 14:49:03,893 - INFO - Epoch  74/1000 | Train njNLL: -0.370391 | Train mNLL: 0.165148| Val njNLL: -0.073174 | Val mNLL: 0.248647| Time: 85.47s
2025-11-17 14:50:28,996 - INFO - Epoch  75/1000 | Train njNLL: -0.362671 | Train mNLL: 0.170766| Val njNLL: -0.095567 | Val mNLL: 0.228331| Time: 85.10s
2025-11-17 14:51:54,327 - INFO - Epoch  76/1000 | Train njNLL: -0.379493 | Train mNLL: 0.159798| Val njNLL: 0.023234 | Val mNLL: 0.324722| Time: 85.33s
2025-11-17 14:53:19,500 - INFO - Epoch  77/1000 | Train njNLL: -0.343516 | Train mNLL: 0.190421| Val njNLL: -0.119619 | Val mNLL: 0.212201| Time: 85.17s
2025-11-17 14:53:19,802 - INFO - New best model saved with val_loss: -0.119619
2025-11-17 14:54:45,380 - INFO - Epoch  78/1000 | Train njNLL: -0.382048 | Train mNLL: 0.165376| Val njNLL: -0.056634 | Val mNLL: 0.255429| Time: 85.58s
2025-11-17 14:56:11,233 - INFO - Epoch  79/1000 | Train njNLL: -0.368692 | Train mNLL: 0.174232| Val njNLL: -0.046005 | Val mNLL: 0.261413| Time: 85.85s
2025-11-17 14:57:37,342 - INFO - Epoch  80/1000 | Train njNLL: -0.402526 | Train mNLL: 0.156086| Val njNLL: -0.094388 | Val mNLL: 0.229249| Time: 86.11s
2025-11-17 14:59:03,032 - INFO - Epoch  81/1000 | Train njNLL: -0.399098 | Train mNLL: 0.158580| Val njNLL: -0.056932 | Val mNLL: 0.251328| Time: 85.69s
2025-11-17 15:00:28,715 - INFO - Epoch  82/1000 | Train njNLL: -0.387457 | Train mNLL: 0.172422| Val njNLL: -0.083653 | Val mNLL: 0.247699| Time: 85.68s
2025-11-17 15:01:54,269 - INFO - Epoch  83/1000 | Train njNLL: -0.410067 | Train mNLL: 0.156364| Val njNLL: -0.021945 | Val mNLL: 0.296714| Time: 85.55s
2025-11-17 15:03:19,570 - INFO - Epoch  84/1000 | Train njNLL: -0.424668 | Train mNLL: 0.146337| Val njNLL: -0.083862 | Val mNLL: 0.232380| Time: 85.30s
2025-11-17 15:04:45,277 - INFO - Epoch  85/1000 | Train njNLL: -0.436116 | Train mNLL: 0.141183| Val njNLL: -0.054429 | Val mNLL: 0.251920| Time: 85.71s
2025-11-17 15:06:10,557 - INFO - Epoch  86/1000 | Train njNLL: -0.409606 | Train mNLL: 0.162113| Val njNLL: -0.056351 | Val mNLL: 0.255496| Time: 85.28s
2025-11-17 15:07:35,858 - INFO - Epoch  87/1000 | Train njNLL: -0.455117 | Train mNLL: 0.130406| Val njNLL: -0.079856 | Val mNLL: 0.233586| Time: 85.30s
2025-11-17 15:09:02,180 - INFO - Epoch  88/1000 | Train njNLL: -0.430586 | Train mNLL: 0.148959| Val njNLL: -0.079881 | Val mNLL: 0.227088| Time: 86.32s
2025-11-17 15:10:28,185 - INFO - Epoch  89/1000 | Train njNLL: -0.538668 | Train mNLL: 0.092007| Val njNLL: -0.122297 | Val mNLL: 0.190731| Time: 86.00s
2025-11-17 15:10:28,482 - INFO - New best model saved with val_loss: -0.122297
2025-11-17 15:11:54,518 - INFO - Epoch  90/1000 | Train njNLL: -0.564658 | Train mNLL: 0.084645| Val njNLL: -0.123928 | Val mNLL: 0.189254| Time: 86.03s
2025-11-17 15:11:54,820 - INFO - New best model saved with val_loss: -0.123928
2025-11-17 15:13:20,022 - INFO - Epoch  91/1000 | Train njNLL: -0.590313 | Train mNLL: 0.077452| Val njNLL: -0.056677 | Val mNLL: 0.242325| Time: 85.20s
2025-11-17 15:14:45,625 - INFO - Epoch  92/1000 | Train njNLL: -0.613715 | Train mNLL: 0.066050| Val njNLL: -0.041444 | Val mNLL: 0.260843| Time: 85.60s
2025-11-17 15:16:11,540 - INFO - Epoch  93/1000 | Train njNLL: -0.614411 | Train mNLL: 0.069214| Val njNLL: -0.075669 | Val mNLL: 0.227756| Time: 85.91s
2025-11-17 15:17:37,415 - INFO - Epoch  94/1000 | Train njNLL: -0.627881 | Train mNLL: 0.063856| Val njNLL: -0.023217 | Val mNLL: 0.262599| Time: 85.87s
2025-11-17 15:19:03,321 - INFO - Epoch  95/1000 | Train njNLL: -0.635192 | Train mNLL: 0.059763| Val njNLL: -0.065273 | Val mNLL: 0.230631| Time: 85.91s
2025-11-17 15:20:29,185 - INFO - Epoch  96/1000 | Train njNLL: -0.670013 | Train mNLL: 0.038578| Val njNLL: -0.077371 | Val mNLL: 0.211323| Time: 85.86s
2025-11-17 15:21:54,958 - INFO - Epoch  97/1000 | Train njNLL: -0.653720 | Train mNLL: 0.054664| Val njNLL: -0.071335 | Val mNLL: 0.220938| Time: 85.77s
2025-11-17 15:23:21,113 - INFO - Epoch  98/1000 | Train njNLL: -0.660972 | Train mNLL: 0.049666| Val njNLL: -0.071764 | Val mNLL: 0.223493| Time: 86.15s
2025-11-17 15:24:46,823 - INFO - Epoch  99/1000 | Train njNLL: -0.689477 | Train mNLL: 0.035178| Val njNLL: -0.106172 | Val mNLL: 0.197122| Time: 85.71s
2025-11-17 15:26:12,319 - INFO - Epoch 100/1000 | Train njNLL: -0.659463 | Train mNLL: 0.056149| Val njNLL: -0.062258 | Val mNLL: 0.234387| Time: 85.50s
2025-11-17 15:27:38,486 - INFO - Epoch 101/1000 | Train njNLL: -0.648442 | Train mNLL: 0.059498| Val njNLL: -0.075519 | Val mNLL: 0.208246| Time: 86.17s
2025-11-17 15:29:04,266 - INFO - Epoch 102/1000 | Train njNLL: -0.767284 | Train mNLL: 0.000887| Val njNLL: -0.097818 | Val mNLL: 0.202178| Time: 85.78s
2025-11-17 15:30:29,825 - INFO - Epoch 103/1000 | Train njNLL: -0.803929 | Train mNLL: -0.009125| Val njNLL: -0.096179 | Val mNLL: 0.189407| Time: 85.56s
2025-11-17 15:31:55,955 - INFO - Epoch 104/1000 | Train njNLL: -0.816405 | Train mNLL: -0.014552| Val njNLL: -0.075387 | Val mNLL: 0.217991| Time: 86.13s
2025-11-17 15:33:22,305 - INFO - Epoch 105/1000 | Train njNLL: -0.818110 | Train mNLL: -0.011132| Val njNLL: -0.081916 | Val mNLL: 0.200326| Time: 86.35s
2025-11-17 15:34:48,092 - INFO - Epoch 106/1000 | Train njNLL: -0.848843 | Train mNLL: -0.029817| Val njNLL: -0.075702 | Val mNLL: 0.210382| Time: 85.79s
2025-11-17 15:36:13,430 - INFO - Epoch 107/1000 | Train njNLL: -0.858648 | Train mNLL: -0.032495| Val njNLL: -0.042869 | Val mNLL: 0.228602| Time: 85.34s
2025-11-17 15:37:39,087 - INFO - Epoch 108/1000 | Train njNLL: -0.854094 | Train mNLL: -0.026309| Val njNLL: -0.035916 | Val mNLL: 0.227184| Time: 85.66s
2025-11-17 15:39:04,330 - INFO - Epoch 109/1000 | Train njNLL: -0.862980 | Train mNLL: -0.028849| Val njNLL: 0.001622 | Val mNLL: 0.254281| Time: 85.24s
2025-11-17 15:40:29,621 - INFO - Epoch 110/1000 | Train njNLL: -0.851865 | Train mNLL: -0.020393| Val njNLL: -0.077457 | Val mNLL: 0.193791| Time: 85.29s
2025-11-17 15:41:55,095 - INFO - Epoch 111/1000 | Train njNLL: -0.864796 | Train mNLL: -0.025229| Val njNLL: -0.013105 | Val mNLL: 0.248587| Time: 85.47s
2025-11-17 15:43:21,096 - INFO - Epoch 112/1000 | Train njNLL: -0.866376 | Train mNLL: -0.028827| Val njNLL: -0.034096 | Val mNLL: 0.219765| Time: 86.00s
2025-11-17 15:44:46,662 - INFO - Epoch 113/1000 | Train njNLL: -0.958184 | Train mNLL: -0.079884| Val njNLL: -0.046216 | Val mNLL: 0.212434| Time: 85.57s
2025-11-17 15:46:12,117 - INFO - Epoch 114/1000 | Train njNLL: -0.981765 | Train mNLL: -0.084790| Val njNLL: -0.017430 | Val mNLL: 0.233340| Time: 85.45s
2025-11-17 15:47:38,322 - INFO - Epoch 115/1000 | Train njNLL: -0.991789 | Train mNLL: -0.086157| Val njNLL: -0.041830 | Val mNLL: 0.210138| Time: 86.20s
2025-11-17 15:49:04,053 - INFO - Epoch 116/1000 | Train njNLL: -0.992336 | Train mNLL: -0.084046| Val njNLL: -0.007730 | Val mNLL: 0.250384| Time: 85.73s
2025-11-17 15:50:29,872 - INFO - Epoch 117/1000 | Train njNLL: -0.989665 | Train mNLL: -0.080234| Val njNLL: -0.007924 | Val mNLL: 0.247432| Time: 85.82s
2025-11-17 15:51:55,727 - INFO - Epoch 118/1000 | Train njNLL: -0.982946 | Train mNLL: -0.072574| Val njNLL: 0.022189 | Val mNLL: 0.271808| Time: 85.85s
2025-11-17 15:53:21,589 - INFO - Epoch 119/1000 | Train njNLL: -1.001325 | Train mNLL: -0.086056| Val njNLL: -0.040886 | Val mNLL: 0.210315| Time: 85.86s
2025-11-17 15:54:47,290 - INFO - Epoch 120/1000 | Train njNLL: -0.988475 | Train mNLL: -0.074993| Val njNLL: 0.001978 | Val mNLL: 0.248731| Time: 85.70s
2025-11-17 15:54:47,290 - INFO - Early stopping after 30 epochs without improvement
2025-11-17 15:54:47,291 - INFO - Loading best model for final evaluation...
2025-11-17 15:54:57,001 - INFO - Final Results:
2025-11-17 15:54:57,002 - INFO - Best Val nJNLL: -0.123928
2025-11-17 15:54:57,002 - INFO - Test njNLL: -0.124697
2025-11-17 15:54:57,002 - INFO - Test mNLL: 0.195787
2025-11-17 15:54:57,002 - INFO - Test mse: 0.372554
2025-11-17 15:54:57,003 - INFO - Test robust mse: 0.372065
2025-11-17 15:54:57,003 - INFO - Test crps: 0.263641
2025-11-17 15:54:57,003 - INFO - Test energy score: 1.217643
2025-11-17 15:54:57,003 - INFO - Evaluation Time: 9.41s
