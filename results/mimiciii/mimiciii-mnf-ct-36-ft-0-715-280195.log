train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset mimiciii --n-gaussians 1 --flayers 3 --n-heads 1 --encoder grafiti --enc-layers 4 --n-hidden 64 -ct 36 -ft 0 --fold 0
2025-11-17 13:28:54,797 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=3401804719, flayers=3, n_gaussians=1, n_heads=1, encoder='grafiti', enc_layers=4, n_hiddens=64, dataset='mimiciii', forc_time=0, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-17 13:28:54,797 - INFO - Starting training with experiment ID: 2534797
2025-11-17 13:28:54,797 - INFO - Using device: cuda
2025-11-17 13:28:54,834 - INFO - Available Models: {'BRITS', 'TFT', 'N-BEATS', 'GRU-ODE-Bayes', 'Latent-ODE', 'M-RNN', 'ODE-RNN', 'Informer', 'mTAN', 'TPA', 'NCDE', 'IP-Net', 'SET-TS', 'NODE'}
2025-11-17 13:28:54,835 - INFO - Available Datasets: {'M5', 'Human Activity', 'Air Quality', 'Physionet 2019', 'Electricity', 'USHCN', 'tourism1', 'Air Quality Multi-Site', 'M3', 'tourism2', 'Traffic', 'Character Trajectories', 'M4', 'Physionet 2012', 'MuJoCo', 'UWAVE', 'Household Consumption'}
2025-11-17 13:28:55,295 - INFO - Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-17 13:28:55,295 - INFO - NumExpr defaulting to 8 threads.
2025-11-17 13:28:56,999 - WARNING - usetex mode requires TeX.
2025-11-17 13:28:57,160 - INFO - Adding keys as attributes.
2025-11-17 13:29:03,036 - INFO - Model initialized with 275391 parameters
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  1,040
│    │    └─Linear: 3-2                  1,040
│    │    └─Linear: 3-3                  975
│    │    └─Linear: 3-4                  1,040
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  1,040
│    │    └─Linear: 3-6                  1,040
│    │    └─Linear: 3-7                  975
│    │    └─Linear: 3-8                  1,040
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  1,040
│    │    └─Linear: 3-10                 1,040
│    │    └─Linear: 3-11                 975
│    │    └─Linear: 3-12                 1,040
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       65
│    └─Linear: 2-5                       4,160
├─MixtureWeights: 1-3                    64
│    └─Linear: 2-6                       65
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 192
│    │    └─Linear: 3-14                 6,208
│    │    └─Linear: 3-15                 128
│    │    └─ModuleList: 3-16             99,328
│    │    └─ModuleList: 3-17             99,328
│    │    └─ModuleList: 3-18             49,408
│    │    └─Linear: 3-19                 4,160
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 275,391
Trainable params: 275,391
Non-trainable params: 0
=================================================================
2025-11-17 13:29:03,041 - INFO - Model summary:
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  1,040
│    │    └─Linear: 3-2                  1,040
│    │    └─Linear: 3-3                  975
│    │    └─Linear: 3-4                  1,040
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  1,040
│    │    └─Linear: 3-6                  1,040
│    │    └─Linear: 3-7                  975
│    │    └─Linear: 3-8                  1,040
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  1,040
│    │    └─Linear: 3-10                 1,040
│    │    └─Linear: 3-11                 975
│    │    └─Linear: 3-12                 1,040
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       65
│    └─Linear: 2-5                       4,160
├─MixtureWeights: 1-3                    64
│    └─Linear: 2-6                       65
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 192
│    │    └─Linear: 3-14                 6,208
│    │    └─Linear: 3-15                 128
│    │    └─ModuleList: 3-16             99,328
│    │    └─ModuleList: 3-17             99,328
│    │    └─ModuleList: 3-18             49,408
│    │    └─Linear: 3-19                 4,160
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 275,391
Trainable params: 275,391
Non-trainable params: 0
=================================================================
2025-11-17 13:29:03,042 - INFO - Starting training loop...
2025-11-17 13:29:16,429 - INFO - Epoch   1/1000 | Train njNLL: 0.800286 | Train mNLL: 0.848147| Val njNLL: 0.567594 | Val mNLL: 0.614946| Time: 13.39s
2025-11-17 13:29:16,479 - INFO - New best model saved with val_loss: 0.567594
2025-11-17 13:29:25,375 - INFO - Epoch   2/1000 | Train njNLL: 0.467461 | Train mNLL: 0.571570| Val njNLL: 0.360990 | Val mNLL: 0.512777| Time: 8.89s
2025-11-17 13:29:25,416 - INFO - New best model saved with val_loss: 0.360990
2025-11-17 13:29:34,437 - INFO - Epoch   3/1000 | Train njNLL: 0.360555 | Train mNLL: 0.495787| Val njNLL: 0.296628 | Val mNLL: 0.438913| Time: 9.02s
2025-11-17 13:29:34,570 - INFO - New best model saved with val_loss: 0.296628
2025-11-17 13:29:43,674 - INFO - Epoch   4/1000 | Train njNLL: 0.296426 | Train mNLL: 0.454161| Val njNLL: 0.260872 | Val mNLL: 0.404491| Time: 9.10s
2025-11-17 13:29:43,715 - INFO - New best model saved with val_loss: 0.260872
2025-11-17 13:29:52,469 - INFO - Epoch   5/1000 | Train njNLL: 0.267174 | Train mNLL: 0.435311| Val njNLL: 0.214812 | Val mNLL: 0.379599| Time: 8.75s
2025-11-17 13:29:52,510 - INFO - New best model saved with val_loss: 0.214812
2025-11-17 13:30:01,272 - INFO - Epoch   6/1000 | Train njNLL: 0.229289 | Train mNLL: 0.416675| Val njNLL: 0.243762 | Val mNLL: 0.406881| Time: 8.76s
2025-11-17 13:30:10,089 - INFO - Epoch   7/1000 | Train njNLL: 0.205599 | Train mNLL: 0.405643| Val njNLL: 0.215582 | Val mNLL: 0.385035| Time: 8.82s
2025-11-17 13:30:18,984 - INFO - Epoch   8/1000 | Train njNLL: 0.195214 | Train mNLL: 0.397844| Val njNLL: 0.205150 | Val mNLL: 0.381760| Time: 8.89s
2025-11-17 13:30:19,024 - INFO - New best model saved with val_loss: 0.205150
2025-11-17 13:30:27,761 - INFO - Epoch   9/1000 | Train njNLL: 0.171664 | Train mNLL: 0.382695| Val njNLL: 0.177885 | Val mNLL: 0.371441| Time: 8.74s
2025-11-17 13:30:28,349 - INFO - New best model saved with val_loss: 0.177885
2025-11-17 13:30:37,218 - INFO - Epoch  10/1000 | Train njNLL: 0.172753 | Train mNLL: 0.388084| Val njNLL: 0.461174 | Val mNLL: 0.585831| Time: 8.87s
2025-11-17 13:30:46,232 - INFO - Epoch  11/1000 | Train njNLL: 0.159382 | Train mNLL: 0.379644| Val njNLL: 0.206495 | Val mNLL: 0.376426| Time: 9.01s
2025-11-17 13:30:55,097 - INFO - Epoch  12/1000 | Train njNLL: 0.120130 | Train mNLL: 0.355468| Val njNLL: 0.165232 | Val mNLL: 0.363256| Time: 8.87s
2025-11-17 13:30:55,143 - INFO - New best model saved with val_loss: 0.165232
2025-11-17 13:31:03,876 - INFO - Epoch  13/1000 | Train njNLL: 0.110003 | Train mNLL: 0.346579| Val njNLL: 0.109857 | Val mNLL: 0.336850| Time: 8.73s
2025-11-17 13:31:03,917 - INFO - New best model saved with val_loss: 0.109857
2025-11-17 13:31:12,685 - INFO - Epoch  14/1000 | Train njNLL: 0.097799 | Train mNLL: 0.343206| Val njNLL: 0.051892 | Val mNLL: 0.289553| Time: 8.77s
2025-11-17 13:31:12,725 - INFO - New best model saved with val_loss: 0.051892
2025-11-17 13:31:21,307 - INFO - Epoch  15/1000 | Train njNLL: 0.105643 | Train mNLL: 0.351902| Val njNLL: 0.146990 | Val mNLL: 0.371717| Time: 8.58s
2025-11-17 13:31:30,160 - INFO - Epoch  16/1000 | Train njNLL: 0.076113 | Train mNLL: 0.330052| Val njNLL: 0.052452 | Val mNLL: 0.293111| Time: 8.85s
2025-11-17 13:31:39,096 - INFO - Epoch  17/1000 | Train njNLL: 0.084709 | Train mNLL: 0.337932| Val njNLL: 0.113273 | Val mNLL: 0.329154| Time: 8.94s
2025-11-17 13:31:47,840 - INFO - Epoch  18/1000 | Train njNLL: 0.102595 | Train mNLL: 0.348306| Val njNLL: 0.250737 | Val mNLL: 0.450653| Time: 8.74s
2025-11-17 13:31:56,520 - INFO - Epoch  19/1000 | Train njNLL: 0.089934 | Train mNLL: 0.343114| Val njNLL: 0.194870 | Val mNLL: 0.386059| Time: 8.68s
2025-11-17 13:32:05,382 - INFO - Epoch  20/1000 | Train njNLL: 0.065488 | Train mNLL: 0.326951| Val njNLL: 0.087006 | Val mNLL: 0.311118| Time: 8.86s
2025-11-17 13:32:14,077 - INFO - Epoch  21/1000 | Train njNLL: 0.050122 | Train mNLL: 0.312946| Val njNLL: 0.019366 | Val mNLL: 0.277893| Time: 8.69s
2025-11-17 13:32:14,118 - INFO - New best model saved with val_loss: 0.019366
2025-11-17 13:32:23,039 - INFO - Epoch  22/1000 | Train njNLL: 0.044052 | Train mNLL: 0.311750| Val njNLL: 0.043617 | Val mNLL: 0.288000| Time: 8.92s
2025-11-17 13:32:31,836 - INFO - Epoch  23/1000 | Train njNLL: 0.059557 | Train mNLL: 0.324490| Val njNLL: 0.094818 | Val mNLL: 0.316090| Time: 8.80s
2025-11-17 13:32:40,808 - INFO - Epoch  24/1000 | Train njNLL: 0.018175 | Train mNLL: 0.299031| Val njNLL: 0.070735 | Val mNLL: 0.301380| Time: 8.97s
2025-11-17 13:32:49,510 - INFO - Epoch  25/1000 | Train njNLL: 0.050778 | Train mNLL: 0.318692| Val njNLL: 0.134708 | Val mNLL: 0.331956| Time: 8.70s
2025-11-17 13:32:58,351 - INFO - Epoch  26/1000 | Train njNLL: 0.026409 | Train mNLL: 0.303999| Val njNLL: 0.034368 | Val mNLL: 0.279297| Time: 8.84s
2025-11-17 13:33:07,316 - INFO - Epoch  27/1000 | Train njNLL: 0.010913 | Train mNLL: 0.295350| Val njNLL: 0.067712 | Val mNLL: 0.307502| Time: 8.96s
2025-11-17 13:33:16,162 - INFO - Epoch  28/1000 | Train njNLL: 0.021553 | Train mNLL: 0.303356| Val njNLL: 0.040242 | Val mNLL: 0.284816| Time: 8.85s
2025-11-17 13:33:25,161 - INFO - Epoch  29/1000 | Train njNLL: 0.000507 | Train mNLL: 0.291655| Val njNLL: 0.114181 | Val mNLL: 0.337093| Time: 9.00s
2025-11-17 13:33:34,087 - INFO - Epoch  30/1000 | Train njNLL: -0.014217 | Train mNLL: 0.283175| Val njNLL: -0.008644 | Val mNLL: 0.256855| Time: 8.93s
2025-11-17 13:33:34,129 - INFO - New best model saved with val_loss: -0.008644
2025-11-17 13:33:42,901 - INFO - Epoch  31/1000 | Train njNLL: 0.002835 | Train mNLL: 0.295851| Val njNLL: 0.053423 | Val mNLL: 0.304897| Time: 8.77s
2025-11-17 13:33:51,617 - INFO - Epoch  32/1000 | Train njNLL: -0.016226 | Train mNLL: 0.283401| Val njNLL: 0.064321 | Val mNLL: 0.305486| Time: 8.72s
2025-11-17 13:34:00,407 - INFO - Epoch  33/1000 | Train njNLL: -0.042674 | Train mNLL: 0.266649| Val njNLL: 0.019608 | Val mNLL: 0.280485| Time: 8.79s
2025-11-17 13:34:09,373 - INFO - Epoch  34/1000 | Train njNLL: -0.033883 | Train mNLL: 0.273374| Val njNLL: 0.034850 | Val mNLL: 0.281826| Time: 8.97s
2025-11-17 13:34:18,247 - INFO - Epoch  35/1000 | Train njNLL: -0.038216 | Train mNLL: 0.273662| Val njNLL: 0.066750 | Val mNLL: 0.311232| Time: 8.87s
2025-11-17 13:34:27,034 - INFO - Epoch  36/1000 | Train njNLL: -0.037162 | Train mNLL: 0.275122| Val njNLL: 0.032401 | Val mNLL: 0.288825| Time: 8.79s
2025-11-17 13:34:35,901 - INFO - Epoch  37/1000 | Train njNLL: -0.063930 | Train mNLL: 0.257069| Val njNLL: 0.055174 | Val mNLL: 0.318459| Time: 8.87s
2025-11-17 13:34:44,677 - INFO - Epoch  38/1000 | Train njNLL: -0.045101 | Train mNLL: 0.269961| Val njNLL: -0.019993 | Val mNLL: 0.252781| Time: 8.78s
2025-11-17 13:34:44,719 - INFO - New best model saved with val_loss: -0.019993
2025-11-17 13:34:53,610 - INFO - Epoch  39/1000 | Train njNLL: -0.041346 | Train mNLL: 0.274637| Val njNLL: 0.205641 | Val mNLL: 0.401531| Time: 8.89s
2025-11-17 13:35:02,581 - INFO - Epoch  40/1000 | Train njNLL: -0.059789 | Train mNLL: 0.261378| Val njNLL: 0.067325 | Val mNLL: 0.316846| Time: 8.97s
2025-11-17 13:35:11,611 - INFO - Epoch  41/1000 | Train njNLL: -0.072717 | Train mNLL: 0.251252| Val njNLL: -0.034736 | Val mNLL: 0.244925| Time: 9.03s
2025-11-17 13:35:11,652 - INFO - New best model saved with val_loss: -0.034736
2025-11-17 13:35:20,288 - INFO - Epoch  42/1000 | Train njNLL: -0.051450 | Train mNLL: 0.271570| Val njNLL: 0.052823 | Val mNLL: 0.307713| Time: 8.64s
2025-11-17 13:35:29,246 - INFO - Epoch  43/1000 | Train njNLL: -0.076487 | Train mNLL: 0.251086| Val njNLL: 0.171740 | Val mNLL: 0.388031| Time: 8.96s
2025-11-17 13:35:37,983 - INFO - Epoch  44/1000 | Train njNLL: -0.081801 | Train mNLL: 0.249285| Val njNLL: -0.015817 | Val mNLL: 0.262091| Time: 8.74s
2025-11-17 13:35:46,855 - INFO - Epoch  45/1000 | Train njNLL: -0.048397 | Train mNLL: 0.274757| Val njNLL: 0.130721 | Val mNLL: 0.374865| Time: 8.87s
2025-11-17 13:35:55,551 - INFO - Epoch  46/1000 | Train njNLL: -0.050489 | Train mNLL: 0.273411| Val njNLL: 0.005289 | Val mNLL: 0.279555| Time: 8.70s
2025-11-17 13:36:04,448 - INFO - Epoch  47/1000 | Train njNLL: -0.084336 | Train mNLL: 0.248920| Val njNLL: 0.141760 | Val mNLL: 0.365741| Time: 8.90s
2025-11-17 13:36:13,147 - INFO - Epoch  48/1000 | Train njNLL: -0.076095 | Train mNLL: 0.256019| Val njNLL: -0.010381 | Val mNLL: 0.265778| Time: 8.70s
2025-11-17 13:36:21,922 - INFO - Epoch  49/1000 | Train njNLL: -0.077209 | Train mNLL: 0.255311| Val njNLL: -0.042613 | Val mNLL: 0.243204| Time: 8.77s
2025-11-17 13:36:21,964 - INFO - New best model saved with val_loss: -0.042613
2025-11-17 13:36:30,731 - INFO - Epoch  50/1000 | Train njNLL: -0.105846 | Train mNLL: 0.235794| Val njNLL: 0.100337 | Val mNLL: 0.336063| Time: 8.77s
2025-11-17 13:36:39,557 - INFO - Epoch  51/1000 | Train njNLL: -0.102039 | Train mNLL: 0.243962| Val njNLL: -0.045601 | Val mNLL: 0.247500| Time: 8.83s
2025-11-17 13:36:39,598 - INFO - New best model saved with val_loss: -0.045601
2025-11-17 13:36:48,599 - INFO - Epoch  52/1000 | Train njNLL: -0.110951 | Train mNLL: 0.236217| Val njNLL: 0.040154 | Val mNLL: 0.292097| Time: 9.00s
2025-11-17 13:36:57,308 - INFO - Epoch  53/1000 | Train njNLL: -0.112145 | Train mNLL: 0.235697| Val njNLL: -0.014402 | Val mNLL: 0.253751| Time: 8.71s
2025-11-17 13:37:06,212 - INFO - Epoch  54/1000 | Train njNLL: -0.117056 | Train mNLL: 0.234311| Val njNLL: 0.008078 | Val mNLL: 0.276859| Time: 8.90s
2025-11-17 13:37:15,224 - INFO - Epoch  55/1000 | Train njNLL: -0.103453 | Train mNLL: 0.240042| Val njNLL: -0.026271 | Val mNLL: 0.248174| Time: 9.01s
2025-11-17 13:37:24,001 - INFO - Epoch  56/1000 | Train njNLL: -0.129861 | Train mNLL: 0.227201| Val njNLL: 0.040545 | Val mNLL: 0.308692| Time: 8.78s
2025-11-17 13:37:32,876 - INFO - Epoch  57/1000 | Train njNLL: -0.116217 | Train mNLL: 0.234547| Val njNLL: 0.117407 | Val mNLL: 0.360234| Time: 8.88s
2025-11-17 13:37:41,543 - INFO - Epoch  58/1000 | Train njNLL: -0.127513 | Train mNLL: 0.230321| Val njNLL: -0.061600 | Val mNLL: 0.241085| Time: 8.67s
2025-11-17 13:37:41,585 - INFO - New best model saved with val_loss: -0.061600
2025-11-17 13:37:50,196 - INFO - Epoch  59/1000 | Train njNLL: -0.135680 | Train mNLL: 0.224358| Val njNLL: -0.020991 | Val mNLL: 0.257460| Time: 8.61s
2025-11-17 13:37:59,044 - INFO - Epoch  60/1000 | Train njNLL: -0.141180 | Train mNLL: 0.221426| Val njNLL: -0.039187 | Val mNLL: 0.239998| Time: 8.85s
2025-11-17 13:38:07,697 - INFO - Epoch  61/1000 | Train njNLL: -0.153047 | Train mNLL: 0.214020| Val njNLL: -0.043119 | Val mNLL: 0.244167| Time: 8.65s
2025-11-17 13:38:16,387 - INFO - Epoch  62/1000 | Train njNLL: -0.149249 | Train mNLL: 0.215908| Val njNLL: -0.079593 | Val mNLL: 0.225806| Time: 8.69s
2025-11-17 13:38:16,428 - INFO - New best model saved with val_loss: -0.079593
2025-11-17 13:38:25,259 - INFO - Epoch  63/1000 | Train njNLL: -0.164191 | Train mNLL: 0.205825| Val njNLL: -0.030708 | Val mNLL: 0.252922| Time: 8.83s
2025-11-17 13:38:34,265 - INFO - Epoch  64/1000 | Train njNLL: -0.139973 | Train mNLL: 0.223736| Val njNLL: 0.010948 | Val mNLL: 0.291315| Time: 9.01s
2025-11-17 13:38:43,043 - INFO - Epoch  65/1000 | Train njNLL: -0.140626 | Train mNLL: 0.220829| Val njNLL: -0.021645 | Val mNLL: 0.260198| Time: 8.78s
2025-11-17 13:38:51,919 - INFO - Epoch  66/1000 | Train njNLL: -0.145245 | Train mNLL: 0.223609| Val njNLL: 0.021785 | Val mNLL: 0.291690| Time: 8.88s
2025-11-17 13:39:00,787 - INFO - Epoch  67/1000 | Train njNLL: -0.153210 | Train mNLL: 0.216728| Val njNLL: -0.007494 | Val mNLL: 0.261015| Time: 8.87s
2025-11-17 13:39:09,522 - INFO - Epoch  68/1000 | Train njNLL: -0.159349 | Train mNLL: 0.213216| Val njNLL: -0.050095 | Val mNLL: 0.241854| Time: 8.73s
2025-11-17 13:39:18,376 - INFO - Epoch  69/1000 | Train njNLL: -0.175543 | Train mNLL: 0.201781| Val njNLL: -0.057932 | Val mNLL: 0.235483| Time: 8.85s
2025-11-17 13:39:27,337 - INFO - Epoch  70/1000 | Train njNLL: -0.162039 | Train mNLL: 0.216124| Val njNLL: -0.069864 | Val mNLL: 0.228437| Time: 8.96s
2025-11-17 13:39:36,104 - INFO - Epoch  71/1000 | Train njNLL: -0.184885 | Train mNLL: 0.199230| Val njNLL: -0.054529 | Val mNLL: 0.235770| Time: 8.77s
2025-11-17 13:39:44,772 - INFO - Epoch  72/1000 | Train njNLL: -0.169141 | Train mNLL: 0.205324| Val njNLL: -0.032771 | Val mNLL: 0.241244| Time: 8.67s
2025-11-17 13:39:53,621 - INFO - Epoch  73/1000 | Train njNLL: -0.179392 | Train mNLL: 0.200234| Val njNLL: -0.085458 | Val mNLL: 0.212654| Time: 8.85s
2025-11-17 13:39:53,662 - INFO - New best model saved with val_loss: -0.085458
2025-11-17 13:40:02,438 - INFO - Epoch  74/1000 | Train njNLL: -0.169112 | Train mNLL: 0.210566| Val njNLL: -0.091477 | Val mNLL: 0.212264| Time: 8.78s
2025-11-17 13:40:02,479 - INFO - New best model saved with val_loss: -0.091477
2025-11-17 13:40:11,275 - INFO - Epoch  75/1000 | Train njNLL: -0.185994 | Train mNLL: 0.197377| Val njNLL: -0.001525 | Val mNLL: 0.282075| Time: 8.80s
2025-11-17 13:40:20,006 - INFO - Epoch  76/1000 | Train njNLL: -0.169067 | Train mNLL: 0.211632| Val njNLL: 0.031681 | Val mNLL: 0.282926| Time: 8.73s
2025-11-17 13:40:28,764 - INFO - Epoch  77/1000 | Train njNLL: -0.184662 | Train mNLL: 0.201934| Val njNLL: -0.051847 | Val mNLL: 0.239695| Time: 8.76s
2025-11-17 13:40:37,652 - INFO - Epoch  78/1000 | Train njNLL: -0.186464 | Train mNLL: 0.201331| Val njNLL: -0.048752 | Val mNLL: 0.234486| Time: 8.89s
2025-11-17 13:40:46,466 - INFO - Epoch  79/1000 | Train njNLL: -0.193790 | Train mNLL: 0.197063| Val njNLL: 0.017394 | Val mNLL: 0.271167| Time: 8.81s
2025-11-17 13:40:55,190 - INFO - Epoch  80/1000 | Train njNLL: -0.194221 | Train mNLL: 0.198426| Val njNLL: 0.007775 | Val mNLL: 0.274370| Time: 8.72s
2025-11-17 13:41:04,198 - INFO - Epoch  81/1000 | Train njNLL: -0.186655 | Train mNLL: 0.202661| Val njNLL: -0.071050 | Val mNLL: 0.221211| Time: 9.01s
2025-11-17 13:41:13,033 - INFO - Epoch  82/1000 | Train njNLL: -0.175123 | Train mNLL: 0.206822| Val njNLL: -0.043752 | Val mNLL: 0.238689| Time: 8.84s
2025-11-17 13:41:21,806 - INFO - Epoch  83/1000 | Train njNLL: -0.195336 | Train mNLL: 0.196564| Val njNLL: -0.096302 | Val mNLL: 0.210177| Time: 8.77s
2025-11-17 13:41:21,847 - INFO - New best model saved with val_loss: -0.096302
2025-11-17 13:41:30,744 - INFO - Epoch  84/1000 | Train njNLL: -0.175660 | Train mNLL: 0.209390| Val njNLL: -0.054717 | Val mNLL: 0.227763| Time: 8.90s
2025-11-17 13:41:39,411 - INFO - Epoch  85/1000 | Train njNLL: -0.214082 | Train mNLL: 0.188495| Val njNLL: 0.034935 | Val mNLL: 0.279784| Time: 8.67s
2025-11-17 13:41:48,244 - INFO - Epoch  86/1000 | Train njNLL: -0.203564 | Train mNLL: 0.192887| Val njNLL: -0.028683 | Val mNLL: 0.248385| Time: 8.83s
2025-11-17 13:41:56,897 - INFO - Epoch  87/1000 | Train njNLL: -0.213218 | Train mNLL: 0.188801| Val njNLL: -0.031273 | Val mNLL: 0.245741| Time: 8.65s
2025-11-17 13:42:05,641 - INFO - Epoch  88/1000 | Train njNLL: -0.237181 | Train mNLL: 0.173512| Val njNLL: -0.101229 | Val mNLL: 0.203766| Time: 8.74s
2025-11-17 13:42:05,682 - INFO - New best model saved with val_loss: -0.101229
2025-11-17 13:42:14,545 - INFO - Epoch  89/1000 | Train njNLL: -0.234572 | Train mNLL: 0.177141| Val njNLL: -0.049443 | Val mNLL: 0.227704| Time: 8.86s
2025-11-17 13:42:23,395 - INFO - Epoch  90/1000 | Train njNLL: -0.221287 | Train mNLL: 0.185889| Val njNLL: 0.090978 | Val mNLL: 0.324709| Time: 8.85s
2025-11-17 13:42:32,183 - INFO - Epoch  91/1000 | Train njNLL: -0.210935 | Train mNLL: 0.188274| Val njNLL: -0.063783 | Val mNLL: 0.228184| Time: 8.79s
2025-11-17 13:42:40,868 - INFO - Epoch  92/1000 | Train njNLL: -0.218774 | Train mNLL: 0.188856| Val njNLL: 0.031749 | Val mNLL: 0.297655| Time: 8.69s
2025-11-17 13:42:49,616 - INFO - Epoch  93/1000 | Train njNLL: -0.188792 | Train mNLL: 0.204583| Val njNLL: -0.040482 | Val mNLL: 0.242753| Time: 8.75s
2025-11-17 13:42:58,594 - INFO - Epoch  94/1000 | Train njNLL: -0.210627 | Train mNLL: 0.191903| Val njNLL: -0.052348 | Val mNLL: 0.227732| Time: 8.98s
2025-11-17 13:43:07,392 - INFO - Epoch  95/1000 | Train njNLL: -0.249754 | Train mNLL: 0.169133| Val njNLL: -0.044717 | Val mNLL: 0.242704| Time: 8.80s
2025-11-17 13:43:16,256 - INFO - Epoch  96/1000 | Train njNLL: -0.222053 | Train mNLL: 0.188610| Val njNLL: -0.077262 | Val mNLL: 0.226118| Time: 8.86s
2025-11-17 13:43:25,108 - INFO - Epoch  97/1000 | Train njNLL: -0.236336 | Train mNLL: 0.177532| Val njNLL: -0.067516 | Val mNLL: 0.233369| Time: 8.85s
2025-11-17 13:43:33,902 - INFO - Epoch  98/1000 | Train njNLL: -0.244606 | Train mNLL: 0.174819| Val njNLL: -0.018045 | Val mNLL: 0.259052| Time: 8.79s
2025-11-17 13:43:42,548 - INFO - Epoch  99/1000 | Train njNLL: -0.242800 | Train mNLL: 0.174884| Val njNLL: -0.063724 | Val mNLL: 0.225894| Time: 8.65s
2025-11-17 13:43:51,452 - INFO - Epoch 100/1000 | Train njNLL: -0.339902 | Train mNLL: 0.122017| Val njNLL: -0.104383 | Val mNLL: 0.193867| Time: 8.90s
2025-11-17 13:43:51,493 - INFO - New best model saved with val_loss: -0.104383
2025-11-17 13:44:00,379 - INFO - Epoch 101/1000 | Train njNLL: -0.354963 | Train mNLL: 0.119332| Val njNLL: -0.135167 | Val mNLL: 0.181168| Time: 8.89s
2025-11-17 13:44:00,420 - INFO - New best model saved with val_loss: -0.135167
2025-11-17 13:44:09,185 - INFO - Epoch 102/1000 | Train njNLL: -0.362106 | Train mNLL: 0.113656| Val njNLL: -0.080074 | Val mNLL: 0.210395| Time: 8.76s
2025-11-17 13:44:17,862 - INFO - Epoch 103/1000 | Train njNLL: -0.377251 | Train mNLL: 0.107112| Val njNLL: -0.133689 | Val mNLL: 0.173857| Time: 8.68s
2025-11-17 13:44:26,767 - INFO - Epoch 104/1000 | Train njNLL: -0.383374 | Train mNLL: 0.106849| Val njNLL: -0.091646 | Val mNLL: 0.209392| Time: 8.90s
2025-11-17 13:44:35,458 - INFO - Epoch 105/1000 | Train njNLL: -0.370420 | Train mNLL: 0.114986| Val njNLL: -0.144739 | Val mNLL: 0.170360| Time: 8.69s
2025-11-17 13:44:35,499 - INFO - New best model saved with val_loss: -0.144739
2025-11-17 13:44:44,414 - INFO - Epoch 106/1000 | Train njNLL: -0.391658 | Train mNLL: 0.102683| Val njNLL: -0.089758 | Val mNLL: 0.195527| Time: 8.92s
2025-11-17 13:44:53,082 - INFO - Epoch 107/1000 | Train njNLL: -0.397011 | Train mNLL: 0.101844| Val njNLL: -0.147276 | Val mNLL: 0.164331| Time: 8.67s
2025-11-17 13:44:53,123 - INFO - New best model saved with val_loss: -0.147276
2025-11-17 13:45:01,841 - INFO - Epoch 108/1000 | Train njNLL: -0.401244 | Train mNLL: 0.099029| Val njNLL: -0.098598 | Val mNLL: 0.207013| Time: 8.72s
2025-11-17 13:45:10,468 - INFO - Epoch 109/1000 | Train njNLL: -0.422381 | Train mNLL: 0.088862| Val njNLL: -0.120674 | Val mNLL: 0.187187| Time: 8.63s
2025-11-17 13:45:19,244 - INFO - Epoch 110/1000 | Train njNLL: -0.406723 | Train mNLL: 0.099462| Val njNLL: -0.109831 | Val mNLL: 0.185284| Time: 8.78s
2025-11-17 13:45:28,086 - INFO - Epoch 111/1000 | Train njNLL: -0.411546 | Train mNLL: 0.097394| Val njNLL: -0.060740 | Val mNLL: 0.218703| Time: 8.84s
2025-11-17 13:45:36,928 - INFO - Epoch 112/1000 | Train njNLL: -0.396988 | Train mNLL: 0.104727| Val njNLL: -0.023538 | Val mNLL: 0.241527| Time: 8.84s
2025-11-17 13:45:45,562 - INFO - Epoch 113/1000 | Train njNLL: -0.411449 | Train mNLL: 0.096631| Val njNLL: -0.010639 | Val mNLL: 0.255776| Time: 8.63s
2025-11-17 13:45:54,428 - INFO - Epoch 114/1000 | Train njNLL: -0.432884 | Train mNLL: 0.084954| Val njNLL: -0.075266 | Val mNLL: 0.213371| Time: 8.87s
2025-11-17 13:46:03,533 - INFO - Epoch 115/1000 | Train njNLL: -0.425323 | Train mNLL: 0.090309| Val njNLL: -0.117317 | Val mNLL: 0.184363| Time: 9.10s
2025-11-17 13:46:12,313 - INFO - Epoch 116/1000 | Train njNLL: -0.442976 | Train mNLL: 0.078634| Val njNLL: -0.016850 | Val mNLL: 0.241104| Time: 8.78s
2025-11-17 13:46:21,129 - INFO - Epoch 117/1000 | Train njNLL: -0.446867 | Train mNLL: 0.080480| Val njNLL: -0.103999 | Val mNLL: 0.191095| Time: 8.82s
2025-11-17 13:46:29,790 - INFO - Epoch 118/1000 | Train njNLL: -0.429940 | Train mNLL: 0.091627| Val njNLL: -0.043615 | Val mNLL: 0.233635| Time: 8.66s
2025-11-17 13:46:38,669 - INFO - Epoch 119/1000 | Train njNLL: -0.531799 | Train mNLL: 0.037507| Val njNLL: -0.147499 | Val mNLL: 0.166523| Time: 8.88s
2025-11-17 13:46:38,710 - INFO - New best model saved with val_loss: -0.147499
2025-11-17 13:46:47,663 - INFO - Epoch 120/1000 | Train njNLL: -0.548240 | Train mNLL: 0.030309| Val njNLL: -0.155149 | Val mNLL: 0.152884| Time: 8.95s
2025-11-17 13:46:47,703 - INFO - New best model saved with val_loss: -0.155149
2025-11-17 13:46:56,645 - INFO - Epoch 121/1000 | Train njNLL: -0.542296 | Train mNLL: 0.038662| Val njNLL: -0.141580 | Val mNLL: 0.162156| Time: 8.94s
2025-11-17 13:47:05,434 - INFO - Epoch 122/1000 | Train njNLL: -0.557253 | Train mNLL: 0.027314| Val njNLL: -0.161535 | Val mNLL: 0.152484| Time: 8.79s
2025-11-17 13:47:05,475 - INFO - New best model saved with val_loss: -0.161535
2025-11-17 13:47:14,222 - INFO - Epoch 123/1000 | Train njNLL: -0.580343 | Train mNLL: 0.016250| Val njNLL: -0.174050 | Val mNLL: 0.145866| Time: 8.75s
2025-11-17 13:47:14,264 - INFO - New best model saved with val_loss: -0.174050
2025-11-17 13:47:23,093 - INFO - Epoch 124/1000 | Train njNLL: -0.573209 | Train mNLL: 0.024052| Val njNLL: -0.093605 | Val mNLL: 0.187963| Time: 8.83s
2025-11-17 13:47:32,027 - INFO - Epoch 125/1000 | Train njNLL: -0.572970 | Train mNLL: 0.023262| Val njNLL: -0.146113 | Val mNLL: 0.158239| Time: 8.93s
2025-11-17 13:47:40,818 - INFO - Epoch 126/1000 | Train njNLL: -0.592467 | Train mNLL: 0.013511| Val njNLL: -0.128441 | Val mNLL: 0.170639| Time: 8.79s
2025-11-17 13:47:49,721 - INFO - Epoch 127/1000 | Train njNLL: -0.587271 | Train mNLL: 0.016191| Val njNLL: -0.141480 | Val mNLL: 0.159857| Time: 8.90s
2025-11-17 13:47:58,632 - INFO - Epoch 128/1000 | Train njNLL: -0.570809 | Train mNLL: 0.027067| Val njNLL: -0.045536 | Val mNLL: 0.219299| Time: 8.91s
2025-11-17 13:48:07,460 - INFO - Epoch 129/1000 | Train njNLL: -0.567476 | Train mNLL: 0.029758| Val njNLL: -0.043644 | Val mNLL: 0.218439| Time: 8.83s
2025-11-17 13:48:16,320 - INFO - Epoch 130/1000 | Train njNLL: -0.577665 | Train mNLL: 0.023961| Val njNLL: -0.131751 | Val mNLL: 0.167339| Time: 8.86s
2025-11-17 13:48:25,339 - INFO - Epoch 131/1000 | Train njNLL: -0.604067 | Train mNLL: 0.009113| Val njNLL: 0.083099 | Val mNLL: 0.304074| Time: 9.02s
2025-11-17 13:48:34,117 - INFO - Epoch 132/1000 | Train njNLL: -0.593909 | Train mNLL: 0.018122| Val njNLL: -0.123150 | Val mNLL: 0.171566| Time: 8.78s
2025-11-17 13:48:42,880 - INFO - Epoch 133/1000 | Train njNLL: -0.610574 | Train mNLL: 0.006377| Val njNLL: -0.063713 | Val mNLL: 0.214407| Time: 8.76s
2025-11-17 13:48:51,674 - INFO - Epoch 134/1000 | Train njNLL: -0.599682 | Train mNLL: 0.013350| Val njNLL: -0.112324 | Val mNLL: 0.174740| Time: 8.79s
2025-11-17 13:49:00,400 - INFO - Epoch 135/1000 | Train njNLL: -0.677435 | Train mNLL: -0.025883| Val njNLL: -0.131505 | Val mNLL: 0.161120| Time: 8.73s
2025-11-17 13:49:09,206 - INFO - Epoch 136/1000 | Train njNLL: -0.697221 | Train mNLL: -0.034374| Val njNLL: -0.168387 | Val mNLL: 0.139023| Time: 8.81s
2025-11-17 13:49:18,158 - INFO - Epoch 137/1000 | Train njNLL: -0.698917 | Train mNLL: -0.034146| Val njNLL: -0.168146 | Val mNLL: 0.139585| Time: 8.95s
2025-11-17 13:49:26,787 - INFO - Epoch 138/1000 | Train njNLL: -0.711274 | Train mNLL: -0.039686| Val njNLL: -0.159964 | Val mNLL: 0.143796| Time: 8.63s
2025-11-17 13:49:35,902 - INFO - Epoch 139/1000 | Train njNLL: -0.692455 | Train mNLL: -0.027195| Val njNLL: -0.102250 | Val mNLL: 0.186460| Time: 9.11s
2025-11-17 13:49:44,472 - INFO - Epoch 140/1000 | Train njNLL: -0.710017 | Train mNLL: -0.036966| Val njNLL: -0.118911 | Val mNLL: 0.165992| Time: 8.57s
2025-11-17 13:49:53,178 - INFO - Epoch 141/1000 | Train njNLL: -0.722043 | Train mNLL: -0.041285| Val njNLL: -0.152862 | Val mNLL: 0.144151| Time: 8.71s
2025-11-17 13:50:01,948 - INFO - Epoch 142/1000 | Train njNLL: -0.713136 | Train mNLL: -0.035696| Val njNLL: -0.133757 | Val mNLL: 0.157686| Time: 8.77s
2025-11-17 13:50:10,827 - INFO - Epoch 143/1000 | Train njNLL: -0.738834 | Train mNLL: -0.051704| Val njNLL: -0.166668 | Val mNLL: 0.138523| Time: 8.88s
2025-11-17 13:50:19,558 - INFO - Epoch 144/1000 | Train njNLL: -0.741421 | Train mNLL: -0.050008| Val njNLL: -0.174955 | Val mNLL: 0.133825| Time: 8.73s
2025-11-17 13:50:19,599 - INFO - New best model saved with val_loss: -0.174955
2025-11-17 13:50:28,526 - INFO - Epoch 145/1000 | Train njNLL: -0.745344 | Train mNLL: -0.053858| Val njNLL: -0.127999 | Val mNLL: 0.160084| Time: 8.93s
2025-11-17 13:50:37,476 - INFO - Epoch 146/1000 | Train njNLL: -0.723267 | Train mNLL: -0.038216| Val njNLL: -0.144256 | Val mNLL: 0.155080| Time: 8.95s
2025-11-17 13:50:46,451 - INFO - Epoch 147/1000 | Train njNLL: -0.740647 | Train mNLL: -0.048021| Val njNLL: -0.174492 | Val mNLL: 0.133777| Time: 8.97s
2025-11-17 13:50:55,218 - INFO - Epoch 148/1000 | Train njNLL: -0.733103 | Train mNLL: -0.043984| Val njNLL: -0.140616 | Val mNLL: 0.153977| Time: 8.77s
2025-11-17 13:51:04,029 - INFO - Epoch 149/1000 | Train njNLL: -0.750678 | Train mNLL: -0.052361| Val njNLL: -0.120217 | Val mNLL: 0.162764| Time: 8.81s
2025-11-17 13:51:12,940 - INFO - Epoch 150/1000 | Train njNLL: -0.737064 | Train mNLL: -0.044773| Val njNLL: -0.134446 | Val mNLL: 0.155291| Time: 8.91s
2025-11-17 13:51:21,499 - INFO - Epoch 151/1000 | Train njNLL: -0.735887 | Train mNLL: -0.044655| Val njNLL: -0.092395 | Val mNLL: 0.188491| Time: 8.56s
2025-11-17 13:51:30,369 - INFO - Epoch 152/1000 | Train njNLL: -0.763260 | Train mNLL: -0.060624| Val njNLL: -0.149237 | Val mNLL: 0.148458| Time: 8.87s
2025-11-17 13:51:39,161 - INFO - Epoch 153/1000 | Train njNLL: -0.744024 | Train mNLL: -0.047128| Val njNLL: -0.157519 | Val mNLL: 0.140860| Time: 8.79s
2025-11-17 13:51:47,925 - INFO - Epoch 154/1000 | Train njNLL: -0.740312 | Train mNLL: -0.045486| Val njNLL: -0.119467 | Val mNLL: 0.159662| Time: 8.76s
2025-11-17 13:51:56,755 - INFO - Epoch 155/1000 | Train njNLL: -0.749430 | Train mNLL: -0.049448| Val njNLL: -0.138031 | Val mNLL: 0.153616| Time: 8.83s
2025-11-17 13:52:05,606 - INFO - Epoch 156/1000 | Train njNLL: -0.795672 | Train mNLL: -0.073977| Val njNLL: -0.157037 | Val mNLL: 0.140252| Time: 8.85s
2025-11-17 13:52:14,401 - INFO - Epoch 157/1000 | Train njNLL: -0.810047 | Train mNLL: -0.078494| Val njNLL: -0.157004 | Val mNLL: 0.144666| Time: 8.80s
2025-11-17 13:52:23,198 - INFO - Epoch 158/1000 | Train njNLL: -0.810278 | Train mNLL: -0.076982| Val njNLL: -0.162417 | Val mNLL: 0.139193| Time: 8.80s
2025-11-17 13:52:31,987 - INFO - Epoch 159/1000 | Train njNLL: -0.833878 | Train mNLL: -0.090394| Val njNLL: -0.140789 | Val mNLL: 0.147215| Time: 8.79s
2025-11-17 13:52:40,850 - INFO - Epoch 160/1000 | Train njNLL: -0.830449 | Train mNLL: -0.088361| Val njNLL: -0.165932 | Val mNLL: 0.132912| Time: 8.86s
2025-11-17 13:52:49,559 - INFO - Epoch 161/1000 | Train njNLL: -0.834684 | Train mNLL: -0.089526| Val njNLL: -0.108651 | Val mNLL: 0.166597| Time: 8.71s
2025-11-17 13:52:58,260 - INFO - Epoch 162/1000 | Train njNLL: -0.849294 | Train mNLL: -0.098690| Val njNLL: -0.162414 | Val mNLL: 0.135647| Time: 8.70s
2025-11-17 13:53:06,989 - INFO - Epoch 163/1000 | Train njNLL: -0.839764 | Train mNLL: -0.091036| Val njNLL: -0.131922 | Val mNLL: 0.158093| Time: 8.73s
2025-11-17 13:53:15,661 - INFO - Epoch 164/1000 | Train njNLL: -0.840048 | Train mNLL: -0.091812| Val njNLL: -0.154043 | Val mNLL: 0.139385| Time: 8.67s
2025-11-17 13:53:24,500 - INFO - Epoch 165/1000 | Train njNLL: -0.831850 | Train mNLL: -0.085387| Val njNLL: -0.158625 | Val mNLL: 0.134623| Time: 8.84s
2025-11-17 13:53:33,168 - INFO - Epoch 166/1000 | Train njNLL: -0.855648 | Train mNLL: -0.098821| Val njNLL: -0.141531 | Val mNLL: 0.144665| Time: 8.67s
2025-11-17 13:53:42,013 - INFO - Epoch 167/1000 | Train njNLL: -0.882682 | Train mNLL: -0.113110| Val njNLL: -0.134829 | Val mNLL: 0.149534| Time: 8.84s
2025-11-17 13:53:50,870 - INFO - Epoch 168/1000 | Train njNLL: -0.892053 | Train mNLL: -0.116506| Val njNLL: -0.147268 | Val mNLL: 0.141940| Time: 8.86s
2025-11-17 13:53:59,731 - INFO - Epoch 169/1000 | Train njNLL: -0.889330 | Train mNLL: -0.113957| Val njNLL: -0.143306 | Val mNLL: 0.146163| Time: 8.86s
2025-11-17 13:54:08,606 - INFO - Epoch 170/1000 | Train njNLL: -0.893797 | Train mNLL: -0.116171| Val njNLL: -0.168568 | Val mNLL: 0.130941| Time: 8.88s
2025-11-17 13:54:17,597 - INFO - Epoch 171/1000 | Train njNLL: -0.903480 | Train mNLL: -0.121020| Val njNLL: -0.168685 | Val mNLL: 0.131068| Time: 8.99s
2025-11-17 13:54:26,303 - INFO - Epoch 172/1000 | Train njNLL: -0.898340 | Train mNLL: -0.117928| Val njNLL: -0.152351 | Val mNLL: 0.140721| Time: 8.71s
2025-11-17 13:54:35,104 - INFO - Epoch 173/1000 | Train njNLL: -0.903435 | Train mNLL: -0.120874| Val njNLL: -0.155160 | Val mNLL: 0.136759| Time: 8.80s
2025-11-17 13:54:44,061 - INFO - Epoch 174/1000 | Train njNLL: -0.903643 | Train mNLL: -0.120542| Val njNLL: -0.147414 | Val mNLL: 0.143591| Time: 8.96s
2025-11-17 13:54:44,061 - INFO - Early stopping after 30 epochs without improvement
2025-11-17 13:54:44,061 - INFO - Loading best model for final evaluation...
2025-11-17 13:54:45,351 - INFO - Final Results:
2025-11-17 13:54:45,352 - INFO - Best Val nJNLL: -0.174955
2025-11-17 13:54:45,352 - INFO - Test njNLL: -0.200637
2025-11-17 13:54:45,352 - INFO - Test mNLL: 0.135694
2025-11-17 13:54:45,352 - INFO - Test mse: 0.364761
2025-11-17 13:54:45,352 - INFO - Test robust mse: 0.363460
2025-11-17 13:54:45,352 - INFO - Test crps: 0.261629
2025-11-17 13:54:45,352 - INFO - Test energy score: 1.208482
2025-11-17 13:54:45,352 - INFO - Evaluation Time: 1.27s
