train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset mimiciii --n-gaussians 1 --flayers 3 --n-heads 1 --encoder grafiti --enc-layers 4 --n-hidden 128 -ct 36 -ft 0 --fold 0
2025-11-17 13:25:44,741 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=1912198529, flayers=3, n_gaussians=1, n_heads=1, encoder='grafiti', enc_layers=4, n_hiddens=128, dataset='mimiciii', forc_time=0, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-17 13:25:44,741 - INFO - Starting training with experiment ID: 2344741
2025-11-17 13:25:44,742 - INFO - Using device: cuda
2025-11-17 13:25:44,775 - INFO - Available Models: {'TFT', 'IP-Net', 'GRU-ODE-Bayes', 'mTAN', 'SET-TS', 'Latent-ODE', 'NODE', 'BRITS', 'N-BEATS', 'Informer', 'ODE-RNN', 'M-RNN', 'NCDE', 'TPA'}
2025-11-17 13:25:44,775 - INFO - Available Datasets: {'Human Activity', 'tourism1', 'Electricity', 'Traffic', 'Physionet 2012', 'Air Quality', 'tourism2', 'MuJoCo', 'UWAVE', 'M3', 'Household Consumption', 'Physionet 2019', 'M5', 'M4', 'Air Quality Multi-Site', 'USHCN', 'Character Trajectories'}
2025-11-17 13:25:44,923 - INFO - Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-17 13:25:44,923 - INFO - NumExpr defaulting to 8 threads.
2025-11-17 13:25:46,419 - WARNING - usetex mode requires TeX.
2025-11-17 13:25:46,541 - INFO - Adding keys as attributes.
2025-11-17 13:25:51,444 - INFO - Model initialized with 1058495 parameters
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    128
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 12,416
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 16,512
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,058,495
Trainable params: 1,058,495
Non-trainable params: 0
=================================================================
2025-11-17 13:25:51,449 - INFO - Model summary:
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    128
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 12,416
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 16,512
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,058,495
Trainable params: 1,058,495
Non-trainable params: 0
=================================================================
2025-11-17 13:25:51,450 - INFO - Starting training loop...
2025-11-17 13:26:03,948 - INFO - Epoch   1/1000 | Train njNLL: 0.732978 | Train mNLL: 0.797438| Val njNLL: 0.505698 | Val mNLL: 0.591306| Time: 12.50s
2025-11-17 13:26:04,068 - INFO - New best model saved with val_loss: 0.505698
2025-11-17 13:26:14,891 - INFO - Epoch   2/1000 | Train njNLL: 0.472503 | Train mNLL: 0.580190| Val njNLL: 0.458496 | Val mNLL: 0.567599| Time: 10.82s
2025-11-17 13:26:15,014 - INFO - New best model saved with val_loss: 0.458496
2025-11-17 13:26:26,260 - INFO - Epoch   3/1000 | Train njNLL: 0.371816 | Train mNLL: 0.512478| Val njNLL: 0.387837 | Val mNLL: 0.492112| Time: 11.25s
2025-11-17 13:26:26,477 - INFO - New best model saved with val_loss: 0.387837
2025-11-17 13:26:37,777 - INFO - Epoch   4/1000 | Train njNLL: 0.352630 | Train mNLL: 0.510258| Val njNLL: 0.326110 | Val mNLL: 0.444643| Time: 11.30s
2025-11-17 13:26:37,900 - INFO - New best model saved with val_loss: 0.326110
2025-11-17 13:26:48,923 - INFO - Epoch   5/1000 | Train njNLL: 0.286529 | Train mNLL: 0.466317| Val njNLL: 0.266648 | Val mNLL: 0.426033| Time: 11.02s
2025-11-17 13:26:49,046 - INFO - New best model saved with val_loss: 0.266648
2025-11-17 13:27:00,413 - INFO - Epoch   6/1000 | Train njNLL: 0.249525 | Train mNLL: 0.432865| Val njNLL: 0.261653 | Val mNLL: 0.431918| Time: 11.37s
2025-11-17 13:27:00,536 - INFO - New best model saved with val_loss: 0.261653
2025-11-17 13:27:11,315 - INFO - Epoch   7/1000 | Train njNLL: 0.222170 | Train mNLL: 0.417644| Val njNLL: 0.263565 | Val mNLL: 0.427628| Time: 10.78s
2025-11-17 13:27:22,587 - INFO - Epoch   8/1000 | Train njNLL: 0.203504 | Train mNLL: 0.405746| Val njNLL: 0.239574 | Val mNLL: 0.410750| Time: 11.27s
2025-11-17 13:27:22,709 - INFO - New best model saved with val_loss: 0.239574
2025-11-17 13:27:33,839 - INFO - Epoch   9/1000 | Train njNLL: 0.204108 | Train mNLL: 0.410597| Val njNLL: 0.214870 | Val mNLL: 0.392885| Time: 11.13s
2025-11-17 13:27:33,962 - INFO - New best model saved with val_loss: 0.214870
2025-11-17 13:27:45,467 - INFO - Epoch  10/1000 | Train njNLL: 0.169426 | Train mNLL: 0.386400| Val njNLL: 0.126343 | Val mNLL: 0.326841| Time: 11.51s
2025-11-17 13:27:45,590 - INFO - New best model saved with val_loss: 0.126343
2025-11-17 13:27:56,536 - INFO - Epoch  11/1000 | Train njNLL: 0.142399 | Train mNLL: 0.369452| Val njNLL: 0.128449 | Val mNLL: 0.346733| Time: 10.95s
2025-11-17 13:28:07,508 - INFO - Epoch  12/1000 | Train njNLL: 0.136713 | Train mNLL: 0.372925| Val njNLL: 0.167017 | Val mNLL: 0.368499| Time: 10.97s
2025-11-17 13:28:18,913 - INFO - Epoch  13/1000 | Train njNLL: 0.101640 | Train mNLL: 0.351586| Val njNLL: 0.101029 | Val mNLL: 0.317246| Time: 11.40s
2025-11-17 13:28:19,036 - INFO - New best model saved with val_loss: 0.101029
2025-11-17 13:28:30,221 - INFO - Epoch  14/1000 | Train njNLL: 0.104408 | Train mNLL: 0.350541| Val njNLL: 0.111988 | Val mNLL: 0.349678| Time: 11.18s
2025-11-17 13:28:41,165 - INFO - Epoch  15/1000 | Train njNLL: 0.105117 | Train mNLL: 0.352409| Val njNLL: 0.187150 | Val mNLL: 0.397892| Time: 10.94s
2025-11-17 13:28:52,186 - INFO - Epoch  16/1000 | Train njNLL: 0.106954 | Train mNLL: 0.355116| Val njNLL: 0.102057 | Val mNLL: 0.335829| Time: 11.02s
2025-11-17 13:29:02,998 - INFO - Epoch  17/1000 | Train njNLL: 0.073846 | Train mNLL: 0.336497| Val njNLL: 0.104829 | Val mNLL: 0.330202| Time: 10.81s
2025-11-17 13:29:14,096 - INFO - Epoch  18/1000 | Train njNLL: 0.057042 | Train mNLL: 0.326696| Val njNLL: 0.092637 | Val mNLL: 0.332075| Time: 11.10s
2025-11-17 13:29:14,219 - INFO - New best model saved with val_loss: 0.092637
2025-11-17 13:29:25,625 - INFO - Epoch  19/1000 | Train njNLL: 0.059072 | Train mNLL: 0.331945| Val njNLL: 0.102024 | Val mNLL: 0.342801| Time: 11.41s
2025-11-17 13:29:36,379 - INFO - Epoch  20/1000 | Train njNLL: 0.064854 | Train mNLL: 0.336002| Val njNLL: 0.205355 | Val mNLL: 0.407793| Time: 10.75s
2025-11-17 13:29:47,521 - INFO - Epoch  21/1000 | Train njNLL: 0.050132 | Train mNLL: 0.329247| Val njNLL: 0.078523 | Val mNLL: 0.325443| Time: 11.14s
2025-11-17 13:29:47,645 - INFO - New best model saved with val_loss: 0.078523
2025-11-17 13:29:59,126 - INFO - Epoch  22/1000 | Train njNLL: 0.016015 | Train mNLL: 0.306630| Val njNLL: 0.182212 | Val mNLL: 0.395347| Time: 11.48s
2025-11-17 13:30:10,432 - INFO - Epoch  23/1000 | Train njNLL: 0.058888 | Train mNLL: 0.339327| Val njNLL: 0.093783 | Val mNLL: 0.335465| Time: 11.31s
2025-11-17 13:30:21,489 - INFO - Epoch  24/1000 | Train njNLL: 0.015286 | Train mNLL: 0.310237| Val njNLL: 0.111745 | Val mNLL: 0.349720| Time: 11.06s
2025-11-17 13:30:32,783 - INFO - Epoch  25/1000 | Train njNLL: 0.033068 | Train mNLL: 0.323895| Val njNLL: 0.021638 | Val mNLL: 0.296850| Time: 11.29s
2025-11-17 13:30:32,922 - INFO - New best model saved with val_loss: 0.021638
2025-11-17 13:30:44,389 - INFO - Epoch  26/1000 | Train njNLL: -0.025987 | Train mNLL: 0.285443| Val njNLL: 0.036473 | Val mNLL: 0.305215| Time: 11.47s
2025-11-17 13:30:55,207 - INFO - Epoch  27/1000 | Train njNLL: -0.006871 | Train mNLL: 0.298693| Val njNLL: 0.215027 | Val mNLL: 0.411357| Time: 10.82s
2025-11-17 13:31:06,117 - INFO - Epoch  28/1000 | Train njNLL: 0.010632 | Train mNLL: 0.310895| Val njNLL: 0.097486 | Val mNLL: 0.343526| Time: 10.91s
2025-11-17 13:31:17,009 - INFO - Epoch  29/1000 | Train njNLL: 0.001063 | Train mNLL: 0.305988| Val njNLL: 0.000012 | Val mNLL: 0.273746| Time: 10.89s
2025-11-17 13:31:17,132 - INFO - New best model saved with val_loss: 0.000012
2025-11-17 13:31:28,377 - INFO - Epoch  30/1000 | Train njNLL: -0.006312 | Train mNLL: 0.303561| Val njNLL: -0.007036 | Val mNLL: 0.265009| Time: 11.25s
2025-11-17 13:31:28,501 - INFO - New best model saved with val_loss: -0.007036
2025-11-17 13:31:39,414 - INFO - Epoch  31/1000 | Train njNLL: -0.044434 | Train mNLL: 0.277066| Val njNLL: 0.036020 | Val mNLL: 0.303537| Time: 10.91s
2025-11-17 13:31:50,717 - INFO - Epoch  32/1000 | Train njNLL: -0.035057 | Train mNLL: 0.285514| Val njNLL: 0.092573 | Val mNLL: 0.344871| Time: 11.30s
2025-11-17 13:32:01,600 - INFO - Epoch  33/1000 | Train njNLL: -0.019604 | Train mNLL: 0.291799| Val njNLL: 0.031327 | Val mNLL: 0.306050| Time: 10.88s
2025-11-17 13:32:12,710 - INFO - Epoch  34/1000 | Train njNLL: -0.034762 | Train mNLL: 0.287777| Val njNLL: 0.092707 | Val mNLL: 0.359623| Time: 11.11s
2025-11-17 13:32:24,065 - INFO - Epoch  35/1000 | Train njNLL: -0.044874 | Train mNLL: 0.277817| Val njNLL: 0.190535 | Val mNLL: 0.411180| Time: 11.36s
2025-11-17 13:32:35,114 - INFO - Epoch  36/1000 | Train njNLL: -0.063630 | Train mNLL: 0.267006| Val njNLL: -0.058448 | Val mNLL: 0.243788| Time: 11.05s
2025-11-17 13:32:35,238 - INFO - New best model saved with val_loss: -0.058448
2025-11-17 13:32:46,650 - INFO - Epoch  37/1000 | Train njNLL: -0.076052 | Train mNLL: 0.261197| Val njNLL: -0.028966 | Val mNLL: 0.252181| Time: 11.41s
2025-11-17 13:32:57,798 - INFO - Epoch  38/1000 | Train njNLL: -0.056244 | Train mNLL: 0.273527| Val njNLL: 0.059054 | Val mNLL: 0.329932| Time: 11.15s
2025-11-17 13:33:08,904 - INFO - Epoch  39/1000 | Train njNLL: -0.046783 | Train mNLL: 0.280554| Val njNLL: -0.020874 | Val mNLL: 0.258468| Time: 11.11s
2025-11-17 13:33:20,204 - INFO - Epoch  40/1000 | Train njNLL: -0.077841 | Train mNLL: 0.260626| Val njNLL: -0.013715 | Val mNLL: 0.271842| Time: 11.30s
2025-11-17 13:33:31,852 - INFO - Epoch  41/1000 | Train njNLL: -0.044715 | Train mNLL: 0.285028| Val njNLL: 0.010668 | Val mNLL: 0.286487| Time: 11.65s
2025-11-17 13:33:43,215 - INFO - Epoch  42/1000 | Train njNLL: -0.092507 | Train mNLL: 0.253391| Val njNLL: 0.062058 | Val mNLL: 0.317807| Time: 11.36s
2025-11-17 13:33:54,578 - INFO - Epoch  43/1000 | Train njNLL: -0.070519 | Train mNLL: 0.266737| Val njNLL: 0.074742 | Val mNLL: 0.335025| Time: 11.36s
2025-11-17 13:34:05,537 - INFO - Epoch  44/1000 | Train njNLL: -0.085468 | Train mNLL: 0.260918| Val njNLL: -0.017840 | Val mNLL: 0.266059| Time: 10.96s
2025-11-17 13:34:16,972 - INFO - Epoch  45/1000 | Train njNLL: -0.084696 | Train mNLL: 0.259885| Val njNLL: 0.073979 | Val mNLL: 0.311653| Time: 11.43s
2025-11-17 13:34:28,455 - INFO - Epoch  46/1000 | Train njNLL: -0.107200 | Train mNLL: 0.244757| Val njNLL: -0.067900 | Val mNLL: 0.229624| Time: 11.48s
2025-11-17 13:34:28,579 - INFO - New best model saved with val_loss: -0.067900
2025-11-17 13:34:40,002 - INFO - Epoch  47/1000 | Train njNLL: -0.094205 | Train mNLL: 0.254157| Val njNLL: -0.040830 | Val mNLL: 0.244978| Time: 11.42s
2025-11-17 13:34:51,333 - INFO - Epoch  48/1000 | Train njNLL: -0.119882 | Train mNLL: 0.238371| Val njNLL: 0.134659 | Val mNLL: 0.362784| Time: 11.33s
2025-11-17 13:35:02,061 - INFO - Epoch  49/1000 | Train njNLL: -0.130811 | Train mNLL: 0.234877| Val njNLL: 0.125133 | Val mNLL: 0.366037| Time: 10.73s
2025-11-17 13:35:13,165 - INFO - Epoch  50/1000 | Train njNLL: -0.131414 | Train mNLL: 0.235472| Val njNLL: -0.037498 | Val mNLL: 0.245642| Time: 11.10s
2025-11-17 13:35:24,327 - INFO - Epoch  51/1000 | Train njNLL: -0.114508 | Train mNLL: 0.245247| Val njNLL: -0.027804 | Val mNLL: 0.249408| Time: 11.16s
2025-11-17 13:35:35,259 - INFO - Epoch  52/1000 | Train njNLL: -0.128827 | Train mNLL: 0.234418| Val njNLL: 0.017042 | Val mNLL: 0.274342| Time: 10.93s
2025-11-17 13:35:46,451 - INFO - Epoch  53/1000 | Train njNLL: -0.133810 | Train mNLL: 0.233896| Val njNLL: -0.029028 | Val mNLL: 0.254565| Time: 11.19s
2025-11-17 13:35:57,455 - INFO - Epoch  54/1000 | Train njNLL: -0.139777 | Train mNLL: 0.228269| Val njNLL: -0.030533 | Val mNLL: 0.256526| Time: 11.00s
2025-11-17 13:36:08,570 - INFO - Epoch  55/1000 | Train njNLL: -0.151800 | Train mNLL: 0.223020| Val njNLL: -0.074181 | Val mNLL: 0.220079| Time: 11.12s
2025-11-17 13:36:08,693 - INFO - New best model saved with val_loss: -0.074181
2025-11-17 13:36:19,927 - INFO - Epoch  56/1000 | Train njNLL: -0.151765 | Train mNLL: 0.222950| Val njNLL: -0.042620 | Val mNLL: 0.248974| Time: 11.23s
2025-11-17 13:36:31,296 - INFO - Epoch  57/1000 | Train njNLL: -0.149195 | Train mNLL: 0.226403| Val njNLL: 0.004070 | Val mNLL: 0.273146| Time: 11.37s
2025-11-17 13:36:42,615 - INFO - Epoch  58/1000 | Train njNLL: -0.157292 | Train mNLL: 0.219966| Val njNLL: -0.017344 | Val mNLL: 0.268585| Time: 11.32s
2025-11-17 13:36:53,988 - INFO - Epoch  59/1000 | Train njNLL: -0.138586 | Train mNLL: 0.238756| Val njNLL: 0.012895 | Val mNLL: 0.286110| Time: 11.37s
2025-11-17 13:37:05,054 - INFO - Epoch  60/1000 | Train njNLL: -0.141352 | Train mNLL: 0.230501| Val njNLL: 0.029212 | Val mNLL: 0.304432| Time: 11.07s
2025-11-17 13:37:15,905 - INFO - Epoch  61/1000 | Train njNLL: -0.168116 | Train mNLL: 0.218256| Val njNLL: -0.045637 | Val mNLL: 0.243782| Time: 10.85s
2025-11-17 13:37:26,916 - INFO - Epoch  62/1000 | Train njNLL: -0.187289 | Train mNLL: 0.205124| Val njNLL: -0.052817 | Val mNLL: 0.238375| Time: 11.01s
2025-11-17 13:37:37,782 - INFO - Epoch  63/1000 | Train njNLL: -0.173449 | Train mNLL: 0.216753| Val njNLL: -0.071735 | Val mNLL: 0.227890| Time: 10.87s
2025-11-17 13:37:48,680 - INFO - Epoch  64/1000 | Train njNLL: -0.205475 | Train mNLL: 0.196420| Val njNLL: -0.041234 | Val mNLL: 0.253210| Time: 10.90s
2025-11-17 13:37:59,900 - INFO - Epoch  65/1000 | Train njNLL: -0.197767 | Train mNLL: 0.202699| Val njNLL: -0.072144 | Val mNLL: 0.225906| Time: 11.22s
2025-11-17 13:38:10,781 - INFO - Epoch  66/1000 | Train njNLL: -0.183190 | Train mNLL: 0.209877| Val njNLL: -0.014286 | Val mNLL: 0.256826| Time: 10.88s
2025-11-17 13:38:21,711 - INFO - Epoch  67/1000 | Train njNLL: -0.305959 | Train mNLL: 0.141934| Val njNLL: -0.109417 | Val mNLL: 0.191053| Time: 10.93s
2025-11-17 13:38:21,833 - INFO - New best model saved with val_loss: -0.109417
2025-11-17 13:38:32,728 - INFO - Epoch  68/1000 | Train njNLL: -0.334481 | Train mNLL: 0.127757| Val njNLL: -0.120721 | Val mNLL: 0.188240| Time: 10.89s
2025-11-17 13:38:32,852 - INFO - New best model saved with val_loss: -0.120721
2025-11-17 13:38:43,886 - INFO - Epoch  69/1000 | Train njNLL: -0.349664 | Train mNLL: 0.124434| Val njNLL: -0.070476 | Val mNLL: 0.209119| Time: 11.03s
2025-11-17 13:38:54,777 - INFO - Epoch  70/1000 | Train njNLL: -0.364298 | Train mNLL: 0.116936| Val njNLL: -0.050259 | Val mNLL: 0.234024| Time: 10.89s
2025-11-17 13:39:05,737 - INFO - Epoch  71/1000 | Train njNLL: -0.374663 | Train mNLL: 0.114471| Val njNLL: 0.138996 | Val mNLL: 0.334743| Time: 10.96s
2025-11-17 13:39:16,945 - INFO - Epoch  72/1000 | Train njNLL: -0.370985 | Train mNLL: 0.117253| Val njNLL: -0.084489 | Val mNLL: 0.202146| Time: 11.21s
2025-11-17 13:39:28,324 - INFO - Epoch  73/1000 | Train njNLL: -0.367778 | Train mNLL: 0.120356| Val njNLL: -0.092801 | Val mNLL: 0.205098| Time: 11.38s
2025-11-17 13:39:39,395 - INFO - Epoch  74/1000 | Train njNLL: -0.400338 | Train mNLL: 0.104580| Val njNLL: -0.083011 | Val mNLL: 0.201014| Time: 11.07s
2025-11-17 13:39:50,687 - INFO - Epoch  75/1000 | Train njNLL: -0.403905 | Train mNLL: 0.103236| Val njNLL: -0.093033 | Val mNLL: 0.193700| Time: 11.29s
2025-11-17 13:40:02,042 - INFO - Epoch  76/1000 | Train njNLL: -0.413343 | Train mNLL: 0.100286| Val njNLL: -0.110754 | Val mNLL: 0.189157| Time: 11.36s
2025-11-17 13:40:13,165 - INFO - Epoch  77/1000 | Train njNLL: -0.418319 | Train mNLL: 0.097824| Val njNLL: -0.115547 | Val mNLL: 0.184812| Time: 11.12s
2025-11-17 13:40:24,101 - INFO - Epoch  78/1000 | Train njNLL: -0.434682 | Train mNLL: 0.091998| Val njNLL: -0.005927 | Val mNLL: 0.242456| Time: 10.94s
2025-11-17 13:40:35,324 - INFO - Epoch  79/1000 | Train njNLL: -0.435009 | Train mNLL: 0.089947| Val njNLL: -0.074367 | Val mNLL: 0.202728| Time: 11.22s
2025-11-17 13:40:46,387 - INFO - Epoch  80/1000 | Train njNLL: -0.521811 | Train mNLL: 0.048396| Val njNLL: -0.131412 | Val mNLL: 0.165845| Time: 11.06s
2025-11-17 13:40:46,722 - INFO - New best model saved with val_loss: -0.131412
2025-11-17 13:40:57,720 - INFO - Epoch  81/1000 | Train njNLL: -0.521912 | Train mNLL: 0.055471| Val njNLL: -0.077266 | Val mNLL: 0.210223| Time: 11.00s
2025-11-17 13:41:08,710 - INFO - Epoch  82/1000 | Train njNLL: -0.590660 | Train mNLL: 0.016913| Val njNLL: -0.081739 | Val mNLL: 0.194260| Time: 10.99s
2025-11-17 13:41:19,715 - INFO - Epoch  83/1000 | Train njNLL: -0.571920 | Train mNLL: 0.033085| Val njNLL: -0.105961 | Val mNLL: 0.175334| Time: 11.01s
2025-11-17 13:41:30,812 - INFO - Epoch  84/1000 | Train njNLL: -0.602312 | Train mNLL: 0.015276| Val njNLL: -0.071778 | Val mNLL: 0.198869| Time: 11.10s
2025-11-17 13:41:42,227 - INFO - Epoch  85/1000 | Train njNLL: -0.594718 | Train mNLL: 0.023234| Val njNLL: -0.069335 | Val mNLL: 0.209095| Time: 11.41s
2025-11-17 13:41:53,750 - INFO - Epoch  86/1000 | Train njNLL: -0.628090 | Train mNLL: 0.005011| Val njNLL: -0.087388 | Val mNLL: 0.183246| Time: 11.52s
2025-11-17 13:42:05,067 - INFO - Epoch  87/1000 | Train njNLL: -0.635022 | Train mNLL: 0.004138| Val njNLL: -0.085932 | Val mNLL: 0.183894| Time: 11.32s
2025-11-17 13:42:15,862 - INFO - Epoch  88/1000 | Train njNLL: -0.619989 | Train mNLL: 0.013227| Val njNLL: -0.041868 | Val mNLL: 0.213791| Time: 10.79s
2025-11-17 13:42:26,788 - INFO - Epoch  89/1000 | Train njNLL: -0.645943 | Train mNLL: -0.000856| Val njNLL: -0.051288 | Val mNLL: 0.200937| Time: 10.93s
2025-11-17 13:42:37,754 - INFO - Epoch  90/1000 | Train njNLL: -0.638060 | Train mNLL: 0.004305| Val njNLL: -0.021643 | Val mNLL: 0.229155| Time: 10.97s
2025-11-17 13:42:48,709 - INFO - Epoch  91/1000 | Train njNLL: -0.655106 | Train mNLL: -0.003261| Val njNLL: -0.042926 | Val mNLL: 0.210852| Time: 10.96s
2025-11-17 13:43:00,086 - INFO - Epoch  92/1000 | Train njNLL: -0.754563 | Train mNLL: -0.056527| Val njNLL: -0.071320 | Val mNLL: 0.186905| Time: 11.38s
2025-11-17 13:43:11,589 - INFO - Epoch  93/1000 | Train njNLL: -0.773024 | Train mNLL: -0.058623| Val njNLL: -0.023654 | Val mNLL: 0.214002| Time: 11.50s
2025-11-17 13:43:22,697 - INFO - Epoch  94/1000 | Train njNLL: -0.750891 | Train mNLL: -0.041057| Val njNLL: -0.027932 | Val mNLL: 0.206991| Time: 11.11s
2025-11-17 13:43:34,022 - INFO - Epoch  95/1000 | Train njNLL: -0.802977 | Train mNLL: -0.069461| Val njNLL: -0.022377 | Val mNLL: 0.214867| Time: 11.32s
2025-11-17 13:43:45,413 - INFO - Epoch  96/1000 | Train njNLL: -0.797165 | Train mNLL: -0.063640| Val njNLL: 0.008464 | Val mNLL: 0.224440| Time: 11.39s
2025-11-17 13:43:56,688 - INFO - Epoch  97/1000 | Train njNLL: -0.820642 | Train mNLL: -0.077421| Val njNLL: -0.032983 | Val mNLL: 0.198008| Time: 11.27s
2025-11-17 13:44:08,092 - INFO - Epoch  98/1000 | Train njNLL: -0.810738 | Train mNLL: -0.069981| Val njNLL: -0.013413 | Val mNLL: 0.214013| Time: 11.40s
2025-11-17 13:44:19,365 - INFO - Epoch  99/1000 | Train njNLL: -0.825317 | Train mNLL: -0.077294| Val njNLL: -0.031379 | Val mNLL: 0.196038| Time: 11.27s
2025-11-17 13:44:30,509 - INFO - Epoch 100/1000 | Train njNLL: -0.821603 | Train mNLL: -0.073995| Val njNLL: -0.017108 | Val mNLL: 0.206548| Time: 11.14s
2025-11-17 13:44:41,457 - INFO - Epoch 101/1000 | Train njNLL: -0.843825 | Train mNLL: -0.085008| Val njNLL: 0.282054 | Val mNLL: 0.390467| Time: 10.95s
2025-11-17 13:44:52,084 - INFO - Epoch 102/1000 | Train njNLL: -0.832536 | Train mNLL: -0.078529| Val njNLL: 0.034472 | Val mNLL: 0.245495| Time: 10.63s
2025-11-17 13:45:02,987 - INFO - Epoch 103/1000 | Train njNLL: -0.910733 | Train mNLL: -0.121097| Val njNLL: 0.028498 | Val mNLL: 0.231845| Time: 10.90s
2025-11-17 13:45:13,833 - INFO - Epoch 104/1000 | Train njNLL: -0.924527 | Train mNLL: -0.120173| Val njNLL: -0.006888 | Val mNLL: 0.208101| Time: 10.85s
2025-11-17 13:45:24,905 - INFO - Epoch 105/1000 | Train njNLL: -0.932299 | Train mNLL: -0.120278| Val njNLL: 0.006886 | Val mNLL: 0.215348| Time: 11.07s
2025-11-17 13:45:36,133 - INFO - Epoch 106/1000 | Train njNLL: -0.939128 | Train mNLL: -0.124852| Val njNLL: 0.007875 | Val mNLL: 0.214080| Time: 11.23s
2025-11-17 13:45:46,987 - INFO - Epoch 107/1000 | Train njNLL: -0.955911 | Train mNLL: -0.132787| Val njNLL: 0.000360 | Val mNLL: 0.206141| Time: 10.85s
2025-11-17 13:45:58,520 - INFO - Epoch 108/1000 | Train njNLL: -0.961054 | Train mNLL: -0.136093| Val njNLL: 0.147716 | Val mNLL: 0.303961| Time: 11.53s
2025-11-17 13:46:09,648 - INFO - Epoch 109/1000 | Train njNLL: -0.951368 | Train mNLL: -0.128627| Val njNLL: 0.115701 | Val mNLL: 0.278628| Time: 11.13s
2025-11-17 13:46:21,139 - INFO - Epoch 110/1000 | Train njNLL: -0.962313 | Train mNLL: -0.133773| Val njNLL: 0.025360 | Val mNLL: 0.218578| Time: 11.49s
2025-11-17 13:46:21,139 - INFO - Early stopping after 30 epochs without improvement
2025-11-17 13:46:21,139 - INFO - Loading best model for final evaluation...
2025-11-17 13:46:22,437 - INFO - Final Results:
2025-11-17 13:46:22,437 - INFO - Best Val nJNLL: -0.131412
2025-11-17 13:46:22,437 - INFO - Test njNLL: -0.157934
2025-11-17 13:46:22,437 - INFO - Test mNLL: 0.166292
2025-11-17 13:46:22,437 - INFO - Test mse: 0.369530
2025-11-17 13:46:22,437 - INFO - Test robust mse: 0.366940
2025-11-17 13:46:22,437 - INFO - Test crps: 0.260929
2025-11-17 13:46:22,437 - INFO - Test energy score: 1.206540
2025-11-17 13:46:22,437 - INFO - Evaluation Time: 1.26s
