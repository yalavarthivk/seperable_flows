train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset physionet2012 --n-gaussians 7 --flayers 3 --n-heads 2 --encoder grafiti --enc-layers 4 --n-hidden 128 -ct 36 -ft 0 --fold 0
2025-11-17 12:09:10,779 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=749377670, flayers=3, n_gaussians=7, n_heads=2, encoder='grafiti', enc_layers=4, n_hiddens=128, dataset='physionet2012', forc_time=0, cond_time=36, nfolds=5, fold=0, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-17 12:09:10,779 - INFO - Starting training with experiment ID: 7750779
2025-11-17 12:09:10,779 - INFO - Using device: cuda
2025-11-17 12:09:10,811 - INFO - Available Models: {'GRU-ODE-Bayes', 'M-RNN', 'Informer', 'TPA', 'SET-TS', 'BRITS', 'NCDE', 'NODE', 'ODE-RNN', 'TFT', 'Latent-ODE', 'N-BEATS', 'mTAN', 'IP-Net'}
2025-11-17 12:09:10,811 - INFO - Available Datasets: {'M5', 'Air Quality Multi-Site', 'Traffic', 'tourism1', 'Character Trajectories', 'Household Consumption', 'UWAVE', 'Air Quality', 'Physionet 2012', 'Electricity', 'M4', 'tourism2', 'USHCN', 'Human Activity', 'MuJoCo', 'M3', 'Physionet 2019'}
2025-11-17 12:09:10,961 - INFO - Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-17 12:09:10,962 - INFO - NumExpr defaulting to 8 threads.
2025-11-17 12:09:12,439 - WARNING - usetex mode requires TeX.
2025-11-17 12:09:12,555 - INFO - Adding keys as attributes.
2025-11-17 12:09:19,208 - INFO - Model initialized with 1150783 parameters
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    896
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 4,864
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 115,584
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,150,783
Trainable params: 1,150,783
Non-trainable params: 0
=================================================================
2025-11-17 12:09:19,213 - INFO - Model summary:
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    896
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 4,864
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 115,584
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,150,783
Trainable params: 1,150,783
Non-trainable params: 0
=================================================================
2025-11-17 12:09:19,214 - INFO - Starting training loop...
2025-11-17 12:09:26,467 - INFO - Epoch   1/1000 | Train njNLL: 0.628844 | Train mNLL: 0.773527| Val njNLL: 0.522066 | Val mNLL: 0.722105| Time: 7.25s
2025-11-17 12:09:26,597 - INFO - New best model saved with val_loss: 0.522066
2025-11-17 12:09:32,488 - INFO - Epoch   2/1000 | Train njNLL: 0.371399 | Train mNLL: 0.516930| Val njNLL: 0.330773 | Val mNLL: 0.472365| Time: 5.89s
2025-11-17 12:09:32,622 - INFO - New best model saved with val_loss: 0.330773
2025-11-17 12:09:38,505 - INFO - Epoch   3/1000 | Train njNLL: 0.275655 | Train mNLL: 0.425932| Val njNLL: 0.185205 | Val mNLL: 0.326287| Time: 5.88s
2025-11-17 12:09:38,638 - INFO - New best model saved with val_loss: 0.185205
2025-11-17 12:09:44,526 - INFO - Epoch   4/1000 | Train njNLL: 0.215803 | Train mNLL: 0.362072| Val njNLL: 0.170986 | Val mNLL: 0.310842| Time: 5.89s
2025-11-17 12:09:44,659 - INFO - New best model saved with val_loss: 0.170986
2025-11-17 12:09:50,530 - INFO - Epoch   5/1000 | Train njNLL: 0.183296 | Train mNLL: 0.328693| Val njNLL: 0.134916 | Val mNLL: 0.277063| Time: 5.87s
2025-11-17 12:09:50,663 - INFO - New best model saved with val_loss: 0.134916
2025-11-17 12:09:56,707 - INFO - Epoch   6/1000 | Train njNLL: 0.181550 | Train mNLL: 0.340630| Val njNLL: 0.183578 | Val mNLL: 0.374335| Time: 6.04s
2025-11-17 12:10:02,763 - INFO - Epoch   7/1000 | Train njNLL: 0.145276 | Train mNLL: 0.316727| Val njNLL: 0.120111 | Val mNLL: 0.289227| Time: 6.06s
2025-11-17 12:10:02,895 - INFO - New best model saved with val_loss: 0.120111
2025-11-17 12:10:08,743 - INFO - Epoch   8/1000 | Train njNLL: 0.104853 | Train mNLL: 0.289385| Val njNLL: 0.094995 | Val mNLL: 0.306532| Time: 5.85s
2025-11-17 12:10:08,876 - INFO - New best model saved with val_loss: 0.094995
2025-11-17 12:10:14,537 - INFO - Epoch   9/1000 | Train njNLL: 0.096087 | Train mNLL: 0.292636| Val njNLL: 0.034314 | Val mNLL: 0.188338| Time: 5.66s
2025-11-17 12:10:14,670 - INFO - New best model saved with val_loss: 0.034314
2025-11-17 12:10:20,408 - INFO - Epoch  10/1000 | Train njNLL: 0.064839 | Train mNLL: 0.283043| Val njNLL: 0.073605 | Val mNLL: 0.340838| Time: 5.74s
2025-11-17 12:10:26,196 - INFO - Epoch  11/1000 | Train njNLL: 0.014226 | Train mNLL: 0.248489| Val njNLL: -0.019462 | Val mNLL: 0.218983| Time: 5.79s
2025-11-17 12:10:26,329 - INFO - New best model saved with val_loss: -0.019462
2025-11-17 12:10:32,168 - INFO - Epoch  12/1000 | Train njNLL: -0.025454 | Train mNLL: 0.212985| Val njNLL: -0.069422 | Val mNLL: 0.159970| Time: 5.84s
2025-11-17 12:10:32,302 - INFO - New best model saved with val_loss: -0.069422
2025-11-17 12:10:38,311 - INFO - Epoch  13/1000 | Train njNLL: -0.017440 | Train mNLL: 0.234293| Val njNLL: 0.005613 | Val mNLL: 0.283939| Time: 6.01s
2025-11-17 12:10:44,451 - INFO - Epoch  14/1000 | Train njNLL: -0.009570 | Train mNLL: 0.245759| Val njNLL: -0.088885 | Val mNLL: 0.121435| Time: 6.14s
2025-11-17 12:10:44,583 - INFO - New best model saved with val_loss: -0.088885
2025-11-17 12:10:50,592 - INFO - Epoch  15/1000 | Train njNLL: -0.057368 | Train mNLL: 0.193638| Val njNLL: 0.044346 | Val mNLL: 0.342130| Time: 6.01s
2025-11-17 12:10:56,468 - INFO - Epoch  16/1000 | Train njNLL: -0.038250 | Train mNLL: 0.224775| Val njNLL: -0.047849 | Val mNLL: 0.201381| Time: 5.88s
2025-11-17 12:11:02,503 - INFO - Epoch  17/1000 | Train njNLL: -0.064719 | Train mNLL: 0.193380| Val njNLL: -0.115502 | Val mNLL: 0.125927| Time: 6.04s
2025-11-17 12:11:02,637 - INFO - New best model saved with val_loss: -0.115502
2025-11-17 12:11:08,518 - INFO - Epoch  18/1000 | Train njNLL: -0.091173 | Train mNLL: 0.169378| Val njNLL: -0.125213 | Val mNLL: 0.113915| Time: 5.88s
2025-11-17 12:11:08,652 - INFO - New best model saved with val_loss: -0.125213
2025-11-17 12:11:14,397 - INFO - Epoch  19/1000 | Train njNLL: -0.083148 | Train mNLL: 0.175846| Val njNLL: -0.091393 | Val mNLL: 0.174174| Time: 5.75s
2025-11-17 12:11:20,180 - INFO - Epoch  20/1000 | Train njNLL: -0.099873 | Train mNLL: 0.163721| Val njNLL: -0.108492 | Val mNLL: 0.150490| Time: 5.78s
2025-11-17 12:11:25,936 - INFO - Epoch  21/1000 | Train njNLL: -0.111714 | Train mNLL: 0.149994| Val njNLL: -0.089583 | Val mNLL: 0.177569| Time: 5.76s
2025-11-17 12:11:31,732 - INFO - Epoch  22/1000 | Train njNLL: -0.115254 | Train mNLL: 0.151469| Val njNLL: -0.174742 | Val mNLL: 0.072692| Time: 5.80s
2025-11-17 12:11:32,073 - INFO - New best model saved with val_loss: -0.174742
2025-11-17 12:11:37,808 - INFO - Epoch  23/1000 | Train njNLL: -0.103292 | Train mNLL: 0.169592| Val njNLL: -0.075360 | Val mNLL: 0.185452| Time: 5.73s
2025-11-17 12:11:43,762 - INFO - Epoch  24/1000 | Train njNLL: -0.120264 | Train mNLL: 0.151788| Val njNLL: -0.143639 | Val mNLL: 0.109689| Time: 5.95s
2025-11-17 12:11:49,849 - INFO - Epoch  25/1000 | Train njNLL: -0.142040 | Train mNLL: 0.125119| Val njNLL: -0.179493 | Val mNLL: 0.066337| Time: 6.09s
2025-11-17 12:11:49,983 - INFO - New best model saved with val_loss: -0.179493
2025-11-17 12:11:56,161 - INFO - Epoch  26/1000 | Train njNLL: -0.152515 | Train mNLL: 0.118937| Val njNLL: -0.113495 | Val mNLL: 0.146701| Time: 6.18s
2025-11-17 12:12:02,099 - INFO - Epoch  27/1000 | Train njNLL: -0.140090 | Train mNLL: 0.132969| Val njNLL: -0.122245 | Val mNLL: 0.134481| Time: 5.94s
2025-11-17 12:12:08,034 - INFO - Epoch  28/1000 | Train njNLL: -0.152997 | Train mNLL: 0.120902| Val njNLL: -0.155292 | Val mNLL: 0.116221| Time: 5.94s
2025-11-17 12:12:13,881 - INFO - Epoch  29/1000 | Train njNLL: -0.147224 | Train mNLL: 0.133863| Val njNLL: -0.057643 | Val mNLL: 0.205202| Time: 5.85s
2025-11-17 12:12:19,717 - INFO - Epoch  30/1000 | Train njNLL: -0.161470 | Train mNLL: 0.117236| Val njNLL: -0.139259 | Val mNLL: 0.129490| Time: 5.84s
2025-11-17 12:12:25,438 - INFO - Epoch  31/1000 | Train njNLL: -0.168297 | Train mNLL: 0.110355| Val njNLL: -0.179693 | Val mNLL: 0.084640| Time: 5.72s
2025-11-17 12:12:25,572 - INFO - New best model saved with val_loss: -0.179693
2025-11-17 12:12:31,279 - INFO - Epoch  32/1000 | Train njNLL: -0.188009 | Train mNLL: 0.091479| Val njNLL: -0.071225 | Val mNLL: 0.211143| Time: 5.71s
2025-11-17 12:12:37,002 - INFO - Epoch  33/1000 | Train njNLL: -0.157547 | Train mNLL: 0.123841| Val njNLL: -0.160333 | Val mNLL: 0.094649| Time: 5.72s
2025-11-17 12:12:42,872 - INFO - Epoch  34/1000 | Train njNLL: -0.188800 | Train mNLL: 0.087941| Val njNLL: -0.186762 | Val mNLL: 0.064163| Time: 5.87s
2025-11-17 12:12:43,005 - INFO - New best model saved with val_loss: -0.186762
2025-11-17 12:12:48,862 - INFO - Epoch  35/1000 | Train njNLL: -0.198523 | Train mNLL: 0.084801| Val njNLL: -0.186379 | Val mNLL: 0.066218| Time: 5.86s
2025-11-17 12:12:54,824 - INFO - Epoch  36/1000 | Train njNLL: -0.203903 | Train mNLL: 0.080508| Val njNLL: -0.129805 | Val mNLL: 0.142662| Time: 5.96s
2025-11-17 12:13:00,897 - INFO - Epoch  37/1000 | Train njNLL: -0.208564 | Train mNLL: 0.078379| Val njNLL: -0.102207 | Val mNLL: 0.172152| Time: 6.07s
2025-11-17 12:13:06,986 - INFO - Epoch  38/1000 | Train njNLL: -0.205847 | Train mNLL: 0.081995| Val njNLL: -0.195384 | Val mNLL: 0.049803| Time: 6.09s
2025-11-17 12:13:07,119 - INFO - New best model saved with val_loss: -0.195384
2025-11-17 12:13:13,048 - INFO - Epoch  39/1000 | Train njNLL: -0.199068 | Train mNLL: 0.090905| Val njNLL: -0.183868 | Val mNLL: 0.080780| Time: 5.93s
2025-11-17 12:13:19,227 - INFO - Epoch  40/1000 | Train njNLL: -0.215005 | Train mNLL: 0.077083| Val njNLL: -0.149321 | Val mNLL: 0.117083| Time: 6.18s
2025-11-17 12:13:25,069 - INFO - Epoch  41/1000 | Train njNLL: -0.225037 | Train mNLL: 0.062784| Val njNLL: -0.199788 | Val mNLL: 0.067986| Time: 5.84s
2025-11-17 12:13:25,201 - INFO - New best model saved with val_loss: -0.199788
2025-11-17 12:13:30,929 - INFO - Epoch  42/1000 | Train njNLL: -0.230780 | Train mNLL: 0.063765| Val njNLL: -0.045641 | Val mNLL: 0.237006| Time: 5.73s
2025-11-17 12:13:37,126 - INFO - Epoch  43/1000 | Train njNLL: -0.235479 | Train mNLL: 0.057492| Val njNLL: -0.208302 | Val mNLL: 0.037309| Time: 6.20s
2025-11-17 12:13:37,261 - INFO - New best model saved with val_loss: -0.208302
2025-11-17 12:13:43,395 - INFO - Epoch  44/1000 | Train njNLL: -0.234853 | Train mNLL: 0.059003| Val njNLL: -0.164723 | Val mNLL: 0.079772| Time: 6.13s
2025-11-17 12:13:49,526 - INFO - Epoch  45/1000 | Train njNLL: -0.185127 | Train mNLL: 0.111693| Val njNLL: -0.183064 | Val mNLL: 0.078010| Time: 6.13s
2025-11-17 12:13:55,460 - INFO - Epoch  46/1000 | Train njNLL: -0.225570 | Train mNLL: 0.078163| Val njNLL: -0.150533 | Val mNLL: 0.106036| Time: 5.93s
2025-11-17 12:14:01,269 - INFO - Epoch  47/1000 | Train njNLL: -0.256551 | Train mNLL: 0.039448| Val njNLL: -0.225448 | Val mNLL: 0.014669| Time: 5.81s
2025-11-17 12:14:01,403 - INFO - New best model saved with val_loss: -0.225448
2025-11-17 12:14:07,417 - INFO - Epoch  48/1000 | Train njNLL: -0.255049 | Train mNLL: 0.045868| Val njNLL: -0.210869 | Val mNLL: 0.028368| Time: 6.01s
2025-11-17 12:14:13,286 - INFO - Epoch  49/1000 | Train njNLL: -0.265784 | Train mNLL: 0.031530| Val njNLL: -0.204486 | Val mNLL: 0.039782| Time: 5.87s
2025-11-17 12:14:19,151 - INFO - Epoch  50/1000 | Train njNLL: -0.274017 | Train mNLL: 0.025605| Val njNLL: -0.206794 | Val mNLL: 0.038057| Time: 5.87s
2025-11-17 12:14:25,098 - INFO - Epoch  51/1000 | Train njNLL: -0.260214 | Train mNLL: 0.041425| Val njNLL: -0.149249 | Val mNLL: 0.108044| Time: 5.95s
2025-11-17 12:14:30,925 - INFO - Epoch  52/1000 | Train njNLL: -0.283493 | Train mNLL: 0.017317| Val njNLL: -0.164725 | Val mNLL: 0.102361| Time: 5.83s
2025-11-17 12:14:36,822 - INFO - Epoch  53/1000 | Train njNLL: -0.293986 | Train mNLL: 0.008162| Val njNLL: -0.200842 | Val mNLL: 0.055992| Time: 5.90s
2025-11-17 12:14:42,628 - INFO - Epoch  54/1000 | Train njNLL: -0.279306 | Train mNLL: 0.031455| Val njNLL: -0.172272 | Val mNLL: 0.085804| Time: 5.81s
2025-11-17 12:14:48,495 - INFO - Epoch  55/1000 | Train njNLL: -0.289131 | Train mNLL: 0.019913| Val njNLL: -0.223718 | Val mNLL: 0.014632| Time: 5.87s
2025-11-17 12:14:54,370 - INFO - Epoch  56/1000 | Train njNLL: -0.287284 | Train mNLL: 0.018221| Val njNLL: -0.040941 | Val mNLL: 0.227343| Time: 5.88s
2025-11-17 12:15:00,611 - INFO - Epoch  57/1000 | Train njNLL: -0.247560 | Train mNLL: 0.063766| Val njNLL: -0.021583 | Val mNLL: 0.244707| Time: 6.24s
2025-11-17 12:15:06,795 - INFO - Epoch  58/1000 | Train njNLL: -0.279711 | Train mNLL: 0.027586| Val njNLL: -0.232773 | Val mNLL: 0.003051| Time: 6.18s
2025-11-17 12:15:06,928 - INFO - New best model saved with val_loss: -0.232773
2025-11-17 12:15:13,035 - INFO - Epoch  59/1000 | Train njNLL: -0.314471 | Train mNLL: 0.000617| Val njNLL: -0.237222 | Val mNLL: 0.001020| Time: 6.11s
2025-11-17 12:15:13,168 - INFO - New best model saved with val_loss: -0.237222
2025-11-17 12:15:19,406 - INFO - Epoch  60/1000 | Train njNLL: -0.312723 | Train mNLL: 0.007935| Val njNLL: -0.186530 | Val mNLL: 0.050213| Time: 6.24s
2025-11-17 12:15:25,477 - INFO - Epoch  61/1000 | Train njNLL: -0.307444 | Train mNLL: 0.011473| Val njNLL: -0.187658 | Val mNLL: 0.037408| Time: 6.07s
2025-11-17 12:15:31,154 - INFO - Epoch  62/1000 | Train njNLL: -0.297113 | Train mNLL: 0.025761| Val njNLL: -0.129247 | Val mNLL: 0.114529| Time: 5.68s
2025-11-17 12:15:37,033 - INFO - Epoch  63/1000 | Train njNLL: -0.336975 | Train mNLL: -0.019963| Val njNLL: -0.157374 | Val mNLL: 0.087665| Time: 5.88s
2025-11-17 12:15:42,999 - INFO - Epoch  64/1000 | Train njNLL: -0.335550 | Train mNLL: -0.016731| Val njNLL: -0.179191 | Val mNLL: 0.044809| Time: 5.97s
2025-11-17 12:15:49,103 - INFO - Epoch  65/1000 | Train njNLL: -0.344069 | Train mNLL: -0.021933| Val njNLL: -0.092895 | Val mNLL: 0.148851| Time: 6.10s
2025-11-17 12:15:55,020 - INFO - Epoch  66/1000 | Train njNLL: -0.322044 | Train mNLL: 0.004854| Val njNLL: -0.197973 | Val mNLL: 0.022252| Time: 5.92s
2025-11-17 12:16:00,802 - INFO - Epoch  67/1000 | Train njNLL: -0.314509 | Train mNLL: 0.008997| Val njNLL: -0.222190 | Val mNLL: 0.002658| Time: 5.78s
2025-11-17 12:16:06,629 - INFO - Epoch  68/1000 | Train njNLL: -0.314445 | Train mNLL: 0.012358| Val njNLL: -0.201193 | Val mNLL: 0.014921| Time: 5.83s
2025-11-17 12:16:12,541 - INFO - Epoch  69/1000 | Train njNLL: -0.358646 | Train mNLL: -0.027971| Val njNLL: -0.157097 | Val mNLL: 0.065376| Time: 5.91s
2025-11-17 12:16:18,638 - INFO - Epoch  70/1000 | Train njNLL: -0.364204 | Train mNLL: -0.029438| Val njNLL: -0.063324 | Val mNLL: 0.196877| Time: 6.10s
2025-11-17 12:16:24,632 - INFO - Epoch  71/1000 | Train njNLL: -0.453672 | Train mNLL: -0.110876| Val njNLL: -0.204556 | Val mNLL: 0.009589| Time: 5.99s
2025-11-17 12:16:30,574 - INFO - Epoch  72/1000 | Train njNLL: -0.473434 | Train mNLL: -0.118959| Val njNLL: -0.231503 | Val mNLL: -0.027337| Time: 5.94s
2025-11-17 12:16:36,370 - INFO - Epoch  73/1000 | Train njNLL: -0.479085 | Train mNLL: -0.120362| Val njNLL: -0.156305 | Val mNLL: 0.064671| Time: 5.80s
2025-11-17 12:16:42,568 - INFO - Epoch  74/1000 | Train njNLL: -0.502187 | Train mNLL: -0.145045| Val njNLL: -0.175275 | Val mNLL: 0.040506| Time: 6.20s
2025-11-17 12:16:48,709 - INFO - Epoch  75/1000 | Train njNLL: -0.508830 | Train mNLL: -0.142343| Val njNLL: -0.100869 | Val mNLL: 0.107738| Time: 6.14s
2025-11-17 12:16:54,844 - INFO - Epoch  76/1000 | Train njNLL: -0.519913 | Train mNLL: -0.155351| Val njNLL: -0.167464 | Val mNLL: 0.042552| Time: 6.14s
2025-11-17 12:17:00,732 - INFO - Epoch  77/1000 | Train njNLL: -0.517008 | Train mNLL: -0.145745| Val njNLL: -0.128461 | Val mNLL: 0.072450| Time: 5.89s
2025-11-17 12:17:06,548 - INFO - Epoch  78/1000 | Train njNLL: -0.536517 | Train mNLL: -0.166902| Val njNLL: -0.218877 | Val mNLL: -0.039074| Time: 5.82s
2025-11-17 12:17:12,342 - INFO - Epoch  79/1000 | Train njNLL: -0.565108 | Train mNLL: -0.194927| Val njNLL: -0.092181 | Val mNLL: 0.117216| Time: 5.79s
2025-11-17 12:17:18,108 - INFO - Epoch  80/1000 | Train njNLL: -0.533237 | Train mNLL: -0.154743| Val njNLL: -0.150037 | Val mNLL: 0.025088| Time: 5.77s
2025-11-17 12:17:23,945 - INFO - Epoch  81/1000 | Train njNLL: -0.556870 | Train mNLL: -0.182240| Val njNLL: -0.125281 | Val mNLL: 0.053947| Time: 5.84s
2025-11-17 12:17:29,783 - INFO - Epoch  82/1000 | Train njNLL: -0.651017 | Train mNLL: -0.273938| Val njNLL: -0.217553 | Val mNLL: -0.058946| Time: 5.84s
2025-11-17 12:17:35,890 - INFO - Epoch  83/1000 | Train njNLL: -0.664429 | Train mNLL: -0.273581| Val njNLL: -0.198421 | Val mNLL: -0.047572| Time: 6.11s
2025-11-17 12:17:41,913 - INFO - Epoch  84/1000 | Train njNLL: -0.664687 | Train mNLL: -0.267109| Val njNLL: -0.183527 | Val mNLL: -0.023686| Time: 6.02s
2025-11-17 12:17:47,720 - INFO - Epoch  85/1000 | Train njNLL: -0.672896 | Train mNLL: -0.271711| Val njNLL: -0.172876 | Val mNLL: -0.023125| Time: 5.81s
2025-11-17 12:17:53,651 - INFO - Epoch  86/1000 | Train njNLL: -0.691906 | Train mNLL: -0.295358| Val njNLL: -0.170122 | Val mNLL: -0.026546| Time: 5.93s
2025-11-17 12:17:59,853 - INFO - Epoch  87/1000 | Train njNLL: -0.702875 | Train mNLL: -0.304507| Val njNLL: -0.059936 | Val mNLL: 0.114793| Time: 6.20s
2025-11-17 12:18:05,941 - INFO - Epoch  88/1000 | Train njNLL: -0.705442 | Train mNLL: -0.303697| Val njNLL: -0.141942 | Val mNLL: -0.008220| Time: 6.09s
2025-11-17 12:18:12,192 - INFO - Epoch  89/1000 | Train njNLL: -0.714640 | Train mNLL: -0.309445| Val njNLL: -0.143893 | Val mNLL: -0.004823| Time: 6.25s
2025-11-17 12:18:12,192 - INFO - Early stopping after 30 epochs without improvement
2025-11-17 12:18:12,192 - INFO - Loading best model for final evaluation...
2025-11-17 12:18:14,185 - INFO - Final Results:
2025-11-17 12:18:14,186 - INFO - Best Val nJNLL: -0.237222
2025-11-17 12:18:14,186 - INFO - Test njNLL: -0.201669
2025-11-17 12:18:14,186 - INFO - Test mNLL: 0.017373
2025-11-17 12:18:14,186 - INFO - Test mse: 0.301633
2025-11-17 12:18:14,186 - INFO - Test robust mse: 0.295626
2025-11-17 12:18:14,186 - INFO - Test crps: 0.255476
2025-11-17 12:18:14,186 - INFO - Test energy score: 1.627105
2025-11-17 12:18:14,186 - INFO - Evaluation Time: 1.96s
