temp_train_mnf.py --batch-size 64 --epochs 1000 -lr 0.001 --dataset ushcn --n-gaussians 3 --flayers 3 --n-heads 4 --encoder grafiti --enc-layers 4 --n-hidden 128 -ct 36 -ft 0 --fold 3
2025-11-17 18:49:32,866 - INFO - Arguments: Namespace(epochs=1000, batch_size=64, val_batch_size=50, learn_rate=0.001, betas=[0.9, 0.999], weight_decay=0.001, seed=59967207, flayers=3, n_gaussians=3, n_heads=4, encoder='grafiti', enc_layers=4, n_hiddens=128, dataset='ushcn', forc_time=0, cond_time=36, nfolds=5, fold=3, bounds=20, num_bins=16, output_dir='saved_models', patience=30, scheduler_patience=10)
2025-11-17 18:49:32,866 - INFO - Starting training with experiment ID: 1772866
2025-11-17 18:49:32,866 - INFO - Using device: cuda
2025-11-17 18:49:32,921 - INFO - Available Models: {'GRU-ODE-Bayes', 'mTAN', 'NCDE', 'SET-TS', 'M-RNN', 'IP-Net', 'BRITS', 'TFT', 'N-BEATS', 'TPA', 'Informer', 'NODE', 'ODE-RNN', 'Latent-ODE'}
2025-11-17 18:49:32,921 - INFO - Available Datasets: {'M4', 'Physionet 2012', 'Household Consumption', 'USHCN', 'M5', 'Electricity', 'Air Quality Multi-Site', 'M3', 'Traffic', 'tourism2', 'MuJoCo', 'Human Activity', 'Character Trajectories', 'UWAVE', 'Air Quality', 'Physionet 2019', 'tourism1'}
2025-11-17 18:49:33,414 - INFO - Note: NumExpr detected 48 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-11-17 18:49:33,415 - INFO - NumExpr defaulting to 8 threads.
2025-11-17 18:49:35,641 - WARNING - usetex mode requires TeX.
2025-11-17 18:49:35,848 - INFO - File 'USHCN_DeBrouwer2019.parquet' validated successfully 'filehash='9d6011771a0001d53a8a083b5df7a005ff7808a2c2d1c6396c3fcbf43aa46994''.
2025-11-17 18:49:36,142 - INFO - File 'USHCN_DeBrouwer2019.parquet' validated successfully 'filehash='9d6011771a0001d53a8a083b5df7a005ff7808a2c2d1c6396c3fcbf43aa46994''.
2025-11-17 18:49:39,699 - INFO - Model initialized with 1080127 parameters
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    384
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 768
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 49,536
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,080,127
Trainable params: 1,080,127
Non-trainable params: 0
=================================================================
2025-11-17 18:49:39,707 - INFO - Model summary:
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
Moses                                    --
├─ModuleList: 1-1                        --
│    └─RationalLinearSplineFlow: 2-1     --
│    │    └─Linear: 3-1                  2,064
│    │    └─Linear: 3-2                  2,064
│    │    └─Linear: 3-3                  1,935
│    │    └─Linear: 3-4                  2,064
│    └─RationalLinearSplineFlow: 2-2     --
│    │    └─Linear: 3-5                  2,064
│    │    └─Linear: 3-6                  2,064
│    │    └─Linear: 3-7                  1,935
│    │    └─Linear: 3-8                  2,064
│    └─RationalLinearSplineFlow: 2-3     --
│    │    └─Linear: 3-9                  2,064
│    │    └─Linear: 3-10                 2,064
│    │    └─Linear: 3-11                 1,935
│    │    └─Linear: 3-12                 2,064
├─MultiGaussian: 1-2                     --
│    └─Linear: 2-4                       129
│    └─Linear: 2-5                       16,512
├─MixtureWeights: 1-3                    384
│    └─Linear: 2-6                       129
├─GraFITi: 1-4                           --
│    └─grafiti_: 2-7                     --
│    │    └─Linear: 3-13                 384
│    │    └─Linear: 3-14                 768
│    │    └─Linear: 3-15                 256
│    │    └─ModuleList: 3-16             395,264
│    │    └─ModuleList: 3-17             395,264
│    │    └─ModuleList: 3-18             197,120
│    │    └─Linear: 3-19                 49,536
│    │    └─ReLU: 3-20                   --
=================================================================
Total params: 1,080,127
Trainable params: 1,080,127
Non-trainable params: 0
=================================================================
2025-11-17 18:49:39,708 - INFO - Starting training loop...
